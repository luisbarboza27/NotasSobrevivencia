<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de Sobrevivencia - 1&nbsp; Preliminares</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./estNP.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminares</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis de Sobrevivencia</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preliminares.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estNP.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimación No-Paramétrica</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PH.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pruebas de Hipótesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RSP.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresión Semiparamétrica con Riesgos Proporcionales</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Referencias</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#características-de-x" id="toc-características-de-x" class="nav-link active" data-scroll-target="#características-de-x"><span class="toc-section-number">1.1</span>  Características de <span class="math inline">\(X\)</span>:</a>
  <ul class="collapse">
  <li><a href="#función-de-sobrevivencia" id="toc-función-de-sobrevivencia" class="nav-link" data-scroll-target="#función-de-sobrevivencia"><span class="toc-section-number">1.1.1</span>  Función de Sobrevivencia</a></li>
  <li><a href="#función-o-tasa-de-riesgo" id="toc-función-o-tasa-de-riesgo" class="nav-link" data-scroll-target="#función-o-tasa-de-riesgo"><span class="toc-section-number">1.1.2</span>  Función o Tasa de Riesgo</a></li>
  <li><a href="#vida-residual-media" id="toc-vida-residual-media" class="nav-link" data-scroll-target="#vida-residual-media"><span class="toc-section-number">1.1.3</span>  Vida Residual Media</a></li>
  </ul></li>
  <li><a href="#modelos-paraméricos-usuales" id="toc-modelos-paraméricos-usuales" class="nav-link" data-scroll-target="#modelos-paraméricos-usuales"><span class="toc-section-number">1.2</span>  Modelos Paraméricos Usuales</a>
  <ul class="collapse">
  <li><a href="#exponencial" id="toc-exponencial" class="nav-link" data-scroll-target="#exponencial"><span class="toc-section-number">1.2.1</span>  Exponencial</a></li>
  <li><a href="#weibull" id="toc-weibull" class="nav-link" data-scroll-target="#weibull"><span class="toc-section-number">1.2.2</span>  Weibull</a></li>
  <li><a href="#log-normal" id="toc-log-normal" class="nav-link" data-scroll-target="#log-normal"><span class="toc-section-number">1.2.3</span>  Log-normal</a></li>
  <li><a href="#log-logístico" id="toc-log-logístico" class="nav-link" data-scroll-target="#log-logístico"><span class="toc-section-number">1.2.4</span>  Log-logístico</a></li>
  <li><a href="#gamma" id="toc-gamma" class="nav-link" data-scroll-target="#gamma"><span class="toc-section-number">1.2.5</span>  Gamma</a></li>
  <li><a href="#gompertz" id="toc-gompertz" class="nav-link" data-scroll-target="#gompertz"><span class="toc-section-number">1.2.6</span>  Gompertz</a></li>
  </ul></li>
  <li><a href="#modelos-de-regresión-para-datos-de-sobrevivencia" id="toc-modelos-de-regresión-para-datos-de-sobrevivencia" class="nav-link" data-scroll-target="#modelos-de-regresión-para-datos-de-sobrevivencia"><span class="toc-section-number">1.3</span>  Modelos de regresión para datos de sobrevivencia</a></li>
  <li><a href="#modelos-de-riesgos-en-competencia" id="toc-modelos-de-riesgos-en-competencia" class="nav-link" data-scroll-target="#modelos-de-riesgos-en-competencia"><span class="toc-section-number">1.4</span>  Modelos de riesgos en competencia</a></li>
  <li><a href="#censura-y-truncamiento" id="toc-censura-y-truncamiento" class="nav-link" data-scroll-target="#censura-y-truncamiento"><span class="toc-section-number">1.5</span>  Censura y Truncamiento</a>
  <ul class="collapse">
  <li><a href="#censura-por-la-derecha" id="toc-censura-por-la-derecha" class="nav-link" data-scroll-target="#censura-por-la-derecha"><span class="toc-section-number">1.5.1</span>  Censura por la derecha</a></li>
  <li><a href="#censura-por-la-izquierda-o-de-intervalo" id="toc-censura-por-la-izquierda-o-de-intervalo" class="nav-link" data-scroll-target="#censura-por-la-izquierda-o-de-intervalo"><span class="toc-section-number">1.5.2</span>  Censura por la izquierda o de intervalo</a></li>
  <li><a href="#truncamiento-1" id="toc-truncamiento-1" class="nav-link" data-scroll-target="#truncamiento-1"><span class="toc-section-number">1.5.3</span>  Truncamiento</a></li>
  </ul></li>
  <li><a href="#verosimilitud-bajo-censura-y-truncamiento" id="toc-verosimilitud-bajo-censura-y-truncamiento" class="nav-link" data-scroll-target="#verosimilitud-bajo-censura-y-truncamiento"><span class="toc-section-number">1.6</span>  Verosimilitud bajo censura y truncamiento</a></li>
  <li><a href="#laboratorio" id="toc-laboratorio" class="nav-link" data-scroll-target="#laboratorio"><span class="toc-section-number">1.7</span>  Laboratorio</a>
  <ul class="collapse">
  <li><a href="#ejemplos-de-datos-de-análisis-de-sobrevivencia" id="toc-ejemplos-de-datos-de-análisis-de-sobrevivencia" class="nav-link" data-scroll-target="#ejemplos-de-datos-de-análisis-de-sobrevivencia"><span class="toc-section-number">1.7.1</span>  Ejemplos de datos de análisis de sobrevivencia</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="prelim" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminares</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Sea <span class="math inline">\(X\)</span> el tiempo de vida hasta un cierto evento. Por ejemplo, este evento puede ser la enfermedad, muerte de un individuo. O bien <span class="math inline">\(X\)</span> puede denotar el tiempo hasta que falle una máquina bajo ciertas condiciones. Asimismo podemos pensar en que la variable <span class="math inline">\(X\)</span> puede representar el tiempo de espera hasta que un ser humano nace desde su concepción.</p>
<p>En todos los casos anteriores, la variable aleatoria <span class="math inline">\(X\)</span> comparte una característica en común: <span class="math inline">\(X\)</span> es una variable aleatoria positiva. Recuerden que en el contexto de distribuciones de pérdidas, ya uds han hecho inferencia de modelos estadísticos de variables aleatorias positivas, pero en un contexto más actuarial y no tan demográfico.</p>
<p>Existen cuatro características de interés para describir la variable <span class="math inline">\(X\)</span>:</p>
<ul>
<li>Función de Sobrevivencia.</li>
<li>Tasa o función de riesgo.</li>
<li>Función de densidad.</li>
<li>Vida residual media de <span class="math inline">\(X\)</span> en un cierto tiempo <span class="math inline">\(x&gt;0\)</span>.</li>
</ul>
<section id="características-de-x" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="características-de-x"><span class="header-section-number">1.1</span> Características de <span class="math inline">\(X\)</span>:</h2>
<p>A continuación explicamos cada característica:</p>
<section id="función-de-sobrevivencia" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="función-de-sobrevivencia"><span class="header-section-number">1.1.1</span> Función de Sobrevivencia</h3>
<div id="def-Sobre" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.1 (Función de sobrevivencia) </strong></span><span class="math display">\[S(x)=P(X&gt;x)\]</span></p>
</div>
<p>En un contexto de tiempo de vida de aparatos o máquinas, a la función <span class="math inline">\(S(x)\)</span> también se le llama función de utilidad o fiabilidad.</p>
<p>Note que si <span class="math inline">\(X\)</span> es una variable aleatoria continua entonces <span class="math inline">\(S(x)\)</span> es una función monótona decreciente. Además, si <span class="math inline">\(f\)</span> es la función de densidad de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[S(x)=1-F(x)=\int_x^{\infty} f(t)dt\]</span> y por lo tanto: <span class="math display">\[f(x)=-\frac{dS(x)}{dx}\]</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Distribución Weibull
</div>
</div>
<div class="callout-body-container callout-body">
<p>En este caso <span class="math inline">\(S(x)=\exp(-\lambda x^{\alpha})\)</span>, para <span class="math inline">\(\lambda&gt;0\)</span> y <span class="math inline">\(\alpha&gt;0\)</span>.</p>
<p>Note que si <span class="math inline">\(\alpha=1\)</span> entonces <span class="math inline">\(X\sim \text{Exponencial}(\lambda)\)</span>.</p>
</div>
</div>
<p>A continuación se ilustra <span class="math inline">\(S(x)\)</span> cuando <span class="math inline">\(\lambda=\alpha=2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>SWeibull <span class="ot">&lt;-</span> <span class="cf">function</span>(x,lambda,alpha){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>x<span class="sc">^</span>(alpha))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> SWeibull,<span class="at">args=</span> <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'S'</span>)<span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En términos generales <span class="math inline">\(S(0)=1\)</span> y <span class="math inline">\(S(\infty)=0\)</span>, para cualquier función de sobrevivencia <span class="math inline">\(S\)</span>. Además, es importante recalcar que una tabla de vida o una tabla de decrementos en general es un <em>estimador</em> de <span class="math inline">\(S\)</span> bajo un cierto conjunto de datos observados.</p>
<p>Note que en el caso discreto: <span class="math display">\[S(x)=\sum_{x_j&gt;x}p(x_j)\]</span></p>
<p>donde <span class="math inline">\(p(x_j)\)</span> es la función de masa evaluada en <span class="math inline">\(x_j\)</span>.</p>
</section>
<section id="función-o-tasa-de-riesgo" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="función-o-tasa-de-riesgo"><span class="header-section-number">1.1.2</span> Función o Tasa de Riesgo</h3>
<p>Esta función se conoce en otros contextos con otros nombres:</p>
<ul>
<li>Tasa de fallo condicional (aparatos electrónicos, ingeniería)</li>
<li>Fuerza de mortalidad (demografía)</li>
<li>Tasa de fallo específica por edad (epidemiología)</li>
<li>Hazard (en inglés)</li>
</ul>
<div id="def-riesgo" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.2 (Función de riesgo) </strong></span><span class="math display">\[h(x)=\lim_{\Delta x\rightarrow 0}\frac{P[x\leq X &lt; x+\Delta x|X\geq x]}{\Delta x}\]</span></p>
</div>
<p>En el caso en que <span class="math inline">\(X\)</span> es una variable aleatoria continua: <span class="math display">\[\begin{align*}
h(x)&amp;=\lim_{\Delta x\rightarrow 0}\frac{F(x+\Delta x)-F(x)}{\Delta x}\cdot \frac{1}{S(x)}\\
&amp;=\frac{f(x)}{S(x)}=-\frac{d}{dx}\log (S(x))
\end{align*}\]</span></p>
<p>Si la función de riesgo se acumula en el intervalo <span class="math inline">\([0,x]\)</span>, se obtiene la <em>función de riesgo acumulativo</em>:</p>
<span class="math display">\[\begin{align*}
H(x)=\int_0^xh(u)du&amp;=-\int_0^x \frac{d}{du}\log(S(u))du\\
&amp;=-\log(S(x)).
\end{align*}\]</span>
<p>Entonces: <span id="eq-sobrevexp"><span class="math display">\[
S(x)=\exp[-H(x)]=\exp\left[-\int_0^th(u)du\right]
\tag{1.1}\]</span></span></p>
<p>en donde a la expresión <span class="math inline">\(h(u)du\)</span> dentro de la integral se le llama <em>probabilidad instantánea del riesgo</em>.</p>
<p>La función de riesgo <span class="math inline">\(h(x)\)</span> necesita ser solamente positiva para asegurar de que la función de sobrevivencia esté bien definida. Por lo tanto no hay muchas restricciones en la forma que tiene la función de riesgo en <span class="math inline">\((0,\infty)\)</span>. Por ejemplo la función de riesgo es monótona creciente en la mayoría de situaciones en donde hay desgaste en las condiciones de existencia en seres o aparatos. También puede ser monótona decreciente en situaciones en donde el riesgo del evento disminuye conforme pasa el tiempo, por ejemplo en el caso de la mortalidad infantil. También se puede tener funciones de riesgo combinadas al tener episodios de riesgo creciente y después de un evento el riesgo disminuye hasta un cierto valor, por ejemplo cuando un paciente es intervenido en un momento de riesgo máximo y después se recupera disminuyendo su riesgo hasta un valor esperable.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Distribución Weibull
</div>
</div>
<div class="callout-body-container callout-body">
<p>En este caso la función de densidad es: <span class="math display">\[f(x)=-\frac{dS(x)}{dx}=\lambda \alpha x^{\alpha-1}\exp(-\lambda x^{\alpha})\]</span> entonces: <span class="math display">\[h(x)= \lambda \alpha x^{\alpha-1}\]</span> Note que si <span class="math inline">\(\alpha=1\)</span> entonces <span class="math inline">\(h(x)=h\alpha\)</span>, si <span class="math inline">\(\alpha&gt;1\)</span> la función de riesgo es creciente y si <span class="math inline">\(\alpha&lt;1\)</span> es decreciente.</p>
</div>
</div>
<p>En el caso en que <span class="math inline">\(\alpha=\lambda=2\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hWeibull <span class="ot">&lt;-</span> <span class="cf">function</span>(x,lambda,alpha){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  lambda<span class="sc">*</span>alpha<span class="sc">*</span>x<span class="sc">^</span>(alpha<span class="dv">-1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> hWeibull,<span class="at">args=</span> <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'h'</span>)<span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para otro caso, ver ejemplo 2.2 del <span class="citation" data-cites="Klein2003a">(<a href="references.html#ref-Klein2003a" role="doc-biblioref">Klein and Moeschberger 2003</a>)</span>.</p>
<p>En el caso en que <span class="math inline">\(X\)</span> es una variable aleatoria discreta: <span class="math display">\[h(x_j)=P[X=x_j|X\geq x_j]=\frac{p(x_j)}{S(x_{j-1})}\]</span> para <span class="math inline">\(j=1,2,\ldots\)</span> y donde <span class="math inline">\(S(x_0)=1\)</span>. Como <span class="math inline">\(p(x_j)=S(x_{j-1})-S(x_j)\)</span> entonces: <span class="math display">\[h(x_j)=1-\frac{S(x_j)}{S(x_{j-1})}\]</span></p>
<p>Además:</p>
<span class="math display">\[\begin{align*}
S(x)&amp;=\prod_{x_j\leq x}\frac{S(x_j)}{S(x_{j-1})}\\
&amp;=\prod_{x_j\leq x}[1-h(x_j)]
\end{align*}\]</span>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Distribución Discreta
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si <span class="math inline">\(p(x_j)=\frac 1 3\)</span> para <span class="math inline">\(j=1,2,3\)</span> entonces: <span class="math display">\[S(x)=P(X&gt;x)=
  \begin{cases}
  1 &amp; 0\leq x &lt;1\\
  2/3 &amp; 1\leq x &lt;2 \\
  1/3 &amp; 2\leq x &lt;3 \\
  0 &amp; x\geq 3
  \end{cases}
\]</span><br>
y <span class="math display">\[h(x)=
    \begin{cases}
  1/3 &amp; j=1 \\
  1/2 &amp; j=2 \\
  1 &amp; j=3
    \end{cases}
  \]</span></p>
</div>
</div>
<p>En términos generales la función de riesgo es más informativa que la función de sobrevivencia.</p>
<p>Siguiendo con el caso discreto: <span class="math display">\[H(x)=\sum_{x_j\leq x}h(x_j)\]</span> y la relación <a href="#eq-sobrevexp">Equation&nbsp;<span>1.1</span></a> no aplica. Otros autores prefieren definir la función de riesgo acumulada: <span class="math display">\[H(x)=-\sum_{x_j\leq x}\log(1-h(x_j))\]</span> y en este caso la relación exponencial entre <span class="math inline">\(S(x)\)</span> y <span class="math inline">\(H(x)\)</span> sí se preserva. Note que si <span class="math inline">\(h(x_j)\approx 0\)</span> entonces la definición anterior de <span class="math inline">\(H(x)\)</span> es una aproximación de Taylor de la definición original.</p>
</section>
<section id="vida-residual-media" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="vida-residual-media"><span class="header-section-number">1.1.3</span> Vida Residual Media</h3>
<p>En muchas aplicaciones se requiere una estimación del tiempo esperado en que el evento va a ocurrir, dadas las condiciones actuales:</p>
<div id="def-vidaresidual" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.3 (Vida Residual Media) </strong></span>&nbsp;</p>
<span class="math display">\[\begin{align*}
    mrl(x)&amp;=E[X-x|X&gt;x]=\frac{\int_x^{\infty}(t-x)f(t)dt}{S(x)}\\
    &amp;=\frac{\int_x^{\infty}S(t)dt}{S(x)}
\end{align*}\]</span>
</div>
<p>Cuando <span class="math inline">\(x=0\)</span>, entonces <span class="math inline">\(mrl(0)=\int_0^{\infty}S(t)dt=EX\)</span>. Por otro lado se puede comprobar (Ejercicio):</p>
<span class="math display">\[\begin{align*}
    \text{Var}(X)=2\int_0^{\infty}tS(t)dt-\left[\int_0^{\infty}S(t)dt\right]^2
\end{align*}\]</span>
<p>Además a partir de la función de sobrevivencia, también se puede calcular el cuantil correspondiente:</p>
<div id="def-cuantilp" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.4 (Cuantil-p) </strong></span>Mínimo <span class="math inline">\(x_p\)</span> tal que <span class="math inline">\(S(x_p)\leq 1-p\)</span>: <span class="math display">\[\inf\{t:S(t)\leq 1-p\}\]</span> En el caso continuo: <span class="math inline">\(S(x_p)=1-p\)</span>.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Ejemplos de vida media
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Exponencial</strong>: Vida media <span class="math inline">\(\mu=EX=\frac 1 \lambda\)</span>. Vida mediana <span class="math inline">\(S(x_{0.5})=0.5\)</span>, entonces:</p>
<p><span class="math display">\[S(x_{0.5})=e^{-\lambda x_{0.5}}=\frac 1 2 \Rightarrow x_{0.5}=\frac{\log 2}{\lambda}\]</span></p>
<p>Vida media residual (usando la propiedad de pérdida de memoria): <span class="math display">\[mrl(x)=E[X-x|X&gt;x]=E[X]=\frac 1 \lambda\]</span></p>
<p><strong>Weibull:</strong>: <span class="math display">\[1-p=\exp(-\lambda x^{\alpha}_p)\Rightarrow x_p=\left[-\frac{\log(1-p)}{\lambda}\right]^{1/\alpha}\]</span></p>
</div>
</div>
<p>En el ejemplo desarrollado anteriormente, en donde <span class="math inline">\(\alpha=\lambda=2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x_05 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="fl">-0.5</span>)<span class="sc">/</span>lambda)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>alpha)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(x_05)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.588705</code></pre>
</div>
</div>
<p>es la vida mediana bajo el supuesto Weibull.</p>
<p>En el caso discreto: <span class="math display">\[mrl(x)=\frac{(x_{i+1}-x)S(x_i)+\sum_{j\geq i+1}(x_{j+1}-x_j)S(x_j)}{S(x)}\qquad \text{para }x_i\leq x&lt;x_{i+1}\]</span></p>
</section>
</section>
<section id="modelos-paraméricos-usuales" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="modelos-paraméricos-usuales"><span class="header-section-number">1.2</span> Modelos Paraméricos Usuales</h2>
<p>Además del caso Weibull, existen otras escogencias para modelar la función de sobrevivencia. Las más usuales son:</p>
<section id="exponencial" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="exponencial"><span class="header-section-number">1.2.1</span> Exponencial</h3>
<span class="math display">\[\begin{align*}
    S(x)&amp;=e^{-\lambda x}, \qquad x&gt;0, \lambda&gt;0\\
    f(x)&amp;=\lambda e^{-\lambda x}\\
    h(x)&amp;=\lambda
\end{align*}\]</span>
<p>Recuerden además que en el caso exponencial se cumple la propiedad de pérdida de memoria: <span class="math inline">\(P(X\geq x+z|X\geq x)=P(X\geq z)\)</span>.</p>
</section>
<section id="weibull" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="weibull"><span class="header-section-number">1.2.2</span> Weibull</h3>
<span class="math display">\[\begin{align*}
    S(x)&amp;=e^{-\lambda x^\alpha}, \qquad x&gt;0, \lambda&gt;0, \alpha&gt;0\\
    h(x)&amp;=\lambda\alpha x^{\alpha-1}
\end{align*}\]</span>
<p>a los parámetros <span class="math inline">\(\lambda\)</span> y <span class="math inline">\(\alpha\)</span> se les llama de escala y forma respectivamente.</p>
<p>Bajo la transformación <span class="math inline">\(Y=\log X\)</span> si <span class="math inline">\(X\sim Weibull\)</span> se puede escribir <span class="math inline">\(Y=\mu+\sigma E\)</span> donde <span class="math inline">\(\mu=\frac{-\log \lambda}{\alpha}\)</span> y <span class="math inline">\(\sigma=\frac 1 \alpha\)</span> y <span class="math inline">\(E\sim\)</span> Valor Extremo Estándar, es decir: <span class="math display">\[f_e(w)=e^{w-e^w}, \quad w\in  \mathbb R\]</span> y <span class="math display">\[S_E(w)=e^{-e^w}\]</span></p>
</section>
<section id="log-normal" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="log-normal"><span class="header-section-number">1.2.3</span> Log-normal</h3>
<p><span class="math inline">\(X\)</span> es una LogNormal<span class="math inline">\((\mu,\sigma^2)\)</span> si <span class="math inline">\(Y=\log X\sim N(\mu,\sigma^2)\)</span>. En este caso:</p>
<span class="math display">\[\begin{align*}
    S(x)&amp;=1-\Phi\left(\frac{\log x-\mu}{\sigma}\right)\\
    h(x)&amp;=\frac{\phi(x)}{S(x)}
\end{align*}\]</span>
<p>En general la tasa de riesgo <span class="math inline">\(h(x)\)</span> no es monótona, por ejemplo tomando <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hLNormal <span class="ot">&lt;-</span> <span class="cf">function</span>(x,mu,sigma){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">plnorm</span>(x,<span class="at">meanlog =</span> mu,<span class="at">sdlog =</span> sigma,<span class="at">lower.tail =</span> F)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> hLNormal,<span class="at">args=</span> <span class="fu">list</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'h'</span>)<span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>lo cual no necesariamente tiene sentido en muchas aplicaciones.</p>
</section>
<section id="log-logístico" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="log-logístico"><span class="header-section-number">1.2.4</span> Log-logístico</h3>
<p><span class="math inline">\(X\)</span> es una variable aleatoria log-logística si <span class="math inline">\(Y=\log X\sim\)</span> logístico: <span class="math display">\[f_Y(y)=\frac{e^{\frac{y-\mu}{\sigma}}}{\sigma\left[1+e^{\frac{y-\mu}{\sigma}}\right]^2},\qquad y \in \mathbb R\]</span></p>
<p>con función de tasa y función de sobrevivencia:</p>
<span class="math display">\[\begin{align*}
    h(x)&amp;=\frac{\alpha \lambda x^{\alpha-1}}{1+\lambda x^\alpha}\qquad \text{más flexible que Weibull}\\
    S(x)&amp;=\frac{1}{1+\lambda x^\alpha}
\end{align*}\]</span>
<p>con <span class="math inline">\(\alpha=\frac 1 \sigma&gt;0\)</span>, <span class="math inline">\(\lambda=e^{-\mu/\sigma}\)</span></p>
</section>
<section id="gamma" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="gamma"><span class="header-section-number">1.2.5</span> Gamma</h3>
<p><span class="math display">\[f(x)=\frac{\lambda^\beta x^{\beta-1}e^{-\lambda x}}{\Gamma(\beta)},\qquad \lambda,\beta,x&gt;0\]</span> Si <span class="math inline">\(\beta=1\)</span>: exponencial, <span class="math inline">\(\beta\longrightarrow \infty\)</span>: Normal. Además <span class="math inline">\(h(x)\)</span> tiene una forma complicada (ver Klein) pero no es muy flexible (solamente crece o decrece).</p>
</section>
<section id="gompertz" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="gompertz"><span class="header-section-number">1.2.6</span> Gompertz</h3>
<span class="math display">\[\begin{align*}
    f(x)&amp;=\theta \exp(\alpha x)\exp \left(\frac \theta \alpha (1-e^{\alpha x})\right)\\
    h(x)&amp;=\theta \exp(\alpha x)
\end{align*}\]</span>
<p>en este caso si <span class="math inline">\(\alpha&gt;1\)</span> y <span class="math inline">\(\theta&gt;0\)</span> entonces <span class="math inline">\(h\)</span> es monótona creciente. Además podemos generalizar levemente la ley anterior por medio del modelo de Makeham: <span class="math display">\[h(x)=\theta \exp(\alpha x)+\lambda\]</span></p>
<p>la cual permite que <span class="math inline">\(h\)</span> sea más flexible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hGompertz <span class="ot">&lt;-</span> <span class="cf">function</span>(x,alpha,theta,lambda){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  theta<span class="sc">*</span><span class="fu">exp</span>(alpha<span class="sc">*</span>x)<span class="sc">+</span>lambda</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> hGompertz,<span class="at">args=</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">theta =</span> <span class="fl">0.5</span>,<span class="at">lambda =</span> <span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'h'</span>)<span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modelos-de-regresión-para-datos-de-sobrevivencia" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="modelos-de-regresión-para-datos-de-sobrevivencia"><span class="header-section-number">1.3</span> Modelos de regresión para datos de sobrevivencia</h2>
<p>Sea <span class="math inline">\(X\)</span> la variable aleatoria de tiempo de fallo u ocurrencia de riesgo. Usualmente la distribución de la variable <span class="math inline">\(X\)</span> se asocia con variables explicativas o covariables:</p>
<p><span class="math display">\[Z^T=(Z_1,\ldots,Z_p)\]</span></p>
<p>donde estas covariables pueden ser cuantitativas o categóricas, y no se descarta la posibilidad de que estas dependan del tiempo <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[Z^T(x)=(Z_1(x),\ldots,Z_p(x))\]</span></p>
<p>Usualmente los modelos de regresión en este contexto se definen de dos formas:</p>
<p><strong>Enfoque 1</strong></p>
<p>Usar la variable dependiente <span class="math inline">\(X\)</span> como variable transformada según <span class="math inline">\(Y=\log(X)\)</span> y hacer la regresión lineal múltiple:</p>
<p><span class="math display">\[Y=\mu+\gamma^TZ+\sigma \epsilon\]</span></p>
<p>donde <span class="math inline">\(\gamma^T=(\gamma_1,\ldots,\gamma_p)\)</span> es un vector de coeficientes y <span class="math inline">\(\epsilon\)</span> es un error independiente que se puede distribuir según:</p>
<ul>
<li>Una normal estándar (Regresión log-normal).</li>
<li>Una distribución de valor extremo estándar (Regresión Weibull)</li>
<li>Una distribución logística (Regresión log-logística).</li>
</ul>
<p>Método de estimación: Máxima Verosimilitud.</p>
<p>Sea <span class="math inline">\(S_0(x)\)</span> la función de sobrevivencia de <span class="math inline">\(X=e^Y\)</span> cuando <span class="math inline">\(Z=0\)</span>, es decir es la función de sobrevivencia de <span class="math inline">\(\exp(\mu+\sigma \epsilon)\)</span>. Entonces:</p>
<span class="math display">\[\begin{align*}
    P[X&gt;x|Z]&amp;=P[Y&gt;\log x|Z]=P[\mu+\gamma^TZ+\sigma \epsilon&gt;\log x|Z]\\
    &amp;=P[\exp(\mu+\sigma \epsilon)&gt;x\exp(-\gamma^T Z)|Z]=S_0(x\exp(-\gamma^T Z)).
\end{align*}\]</span>
<p>Conclusión: el efecto de las covariables <span class="math inline">\(Z\)</span> en la función de sobrevivencia de <span class="math inline">\(X\)</span> es el escalamiento del tiempo <span class="math inline">\(x\)</span> a través del factor <span class="math inline">\(\exp(-\gamma^T Z)\)</span>. Por este motivo a este modelo se le llama modelo de <em>tiempo de fallo acelerado</em>. Su función de riesgo es (ejercicio): <span class="math display">\[h(x|Z)=h_0\left[x\exp(-\gamma^T Z)\right]\exp(-\gamma^T Z)\]</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Regresión Weibull
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea <span class="math inline">\(X\sim Weibull(\lambda, \alpha)\)</span>. Si <span class="math inline">\(Y=\log X\)</span> entonces <span class="math inline">\(Y=\mu+\sigma W\)</span> donde <span class="math inline">\(\mu=-\frac{\log \lambda}{\alpha}\)</span>, <span class="math inline">\(\sigma=\frac 1 \alpha\)</span> y <span class="math inline">\(W\sim \text{VE-Standard}\)</span>, es decir: <span class="math display">\[f_W(w)=\exp\left(w-e^w\right)\qquad w\in \mathbb R\]</span></p>
<p>Si <span class="math inline">\(Z_1=1\)</span> en el vector de covariables <span class="math inline">\(Z\)</span>, entonces bajo el modelo de regresión Weibull, se puede calcular:</p>
<span class="math display">\[\begin{align*}
    S_Y(y|Z)&amp;=P[Y&gt;y|Z]=P\left[W&gt;\frac{y-\gamma^T Z}{\sigma}|Z\right]\\
    &amp;=\exp\left[-\exp\left[\frac{y-\gamma^T Z}{\sigma}\right]\right]
\end{align*}\]</span>
<p>y cambiando a la variable original <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[\begin{align*}
S_X(x|Z)&amp;=\exp\left[-\exp\left[\frac{\log x-\gamma^T Z}{\sigma}\right]\right]=\exp\left[-x^{1/\sigma}\exp\left[-\frac{\gamma^T Z}{\sigma}\right]\right]\\
&amp;=\exp\left[-\left[x\exp(-\gamma^T Z)\right]^\alpha\right]=S_0(x\exp(-\gamma^T Z))
\end{align*}\]</span> donde <span class="math inline">\(S_0\)</span> es la función de sobrevivencia Weibull.</p>
</div>
</div>
<p><strong>Enfoque 2</strong></p>
<p>Modelación de la tasa de riesgo condicional</p>
<p>En este enfoque se trabaja con dos tipos de modelos:</p>
<ol type="a">
<li>Modelos con tasa de riesgo multiplicativa:</li>
</ol>
<p><span id="eq-riesgom"><span class="math display">\[
h(x|Z)=h_0(x)c(\beta^T Z)
\tag{1.2}\]</span></span></p>
<p>donde <span class="math inline">\(h_0\)</span> puede ser una función paramétrica o arbitraria y <span class="math inline">\(c\)</span> es una función arbitraria no-negativa. Cuando</p>
<p><span class="math display">\[c(\beta^T Z)=\exp(\beta^T Z)\]</span></p>
<p>al modelo en <a href="#eq-riesgom">Equation&nbsp;<span>1.2</span></a> se le llama Modelo de Cox. Para este último modelo, si existe dos individuos con distinto conjunto de covariables <span class="math inline">\(Z_1\)</span> y <span class="math inline">\(Z_2\)</span>. Entonces:</p>
<p><span class="math display">\[\frac{h(x|Z_1)}{h(x|Z_2)}=\frac{c(\beta^TZ_1)}{c(\beta^TZ_2)}\]</span></p>
<p>lo cual es independiente de <span class="math inline">\(x\)</span> (propiedad de riesgos proporcionales). Además, note que</p>
<span class="math display">\[\begin{align*}
    S(x|Z)&amp;=\exp\left[-\int_0^xh(u|Z)du\right]=\exp\left[-c(\beta^T Z)\int_0^xh_0(u)du\right]\\
    &amp;=S_0(x)^{c(\beta^T Z)}.
\end{align*}\]</span>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Regresión Weibull
</div>
</div>
<div class="callout-body-container callout-body">
<p>En el caso Weibull: <span class="math inline">\(h_0(x)=\alpha \lambda x^{\alpha-1}\)</span> y la función de riesgo condicional en el caso de un modelo de Cox es: <span class="math display">\[h(x|Z)=\alpha \lambda x^{\alpha-1}\exp(\beta^T Z)\]</span></p>
<p>Note que en este caso: <span class="math display">\[\begin{align*}
    S(x|Z)&amp;=S_0(x)^{c(\beta^T Z)}\\
    &amp;=\exp[-\lambda (x\exp(\beta^T Z/\alpha))^\alpha]=S_0(x\exp(\beta^T Z/\alpha))
\end{align*}\]</span><br>
por lo cual el modelo de regresión Weibull se puede expresar como modelo de tiempo de fallo acelerado o bien como modelo de riesgos proporcionales. (único caso)</p>
</div>
</div>
<ol start="2" type="a">
<li>Modelos con tasa de riesgo aditiva: <span class="math display">\[h(x|Z)=h_0(x)+\sum_{j=1}^pZ_j(x)\beta_j(x)\]</span></li>
</ol>
<p>Este tipo de modelo tiene dificultades extra, por ejemplo los parámetros <span class="math inline">\(\beta_j(x)\)</span> deben ser seleccionados de manera que la tasa de riesgo <span class="math inline">\(h(x|Z)\)</span> sea positiva. Por otro lado también <span class="math inline">\(\beta_j(x)\)</span> puede depender del tiempo <span class="math inline">\(x\)</span>.</p>
</section>
<section id="modelos-de-riesgos-en-competencia" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="modelos-de-riesgos-en-competencia"><span class="header-section-number">1.4</span> Modelos de riesgos en competencia</h2>
<p>Si <span class="math inline">\(T\)</span> denota el tiempo de fallo o bien el tiempo hasta que ocurre un evento. En este contexto, puede ser que existan <span class="math inline">\(K\)</span> distintas causas del fallo. Por ejemplo, ante el evento de muerte a los 65 años, esta se puede deber a muchas causas.</p>
<p>Sea <span class="math inline">\(X_i\)</span> el tiempo hasta que ocurra el <span class="math inline">\(i\)</span>-ésimo riesgo en competencia. Sea <span class="math inline">\(T=\min(X_1,\ldots,X_K)\)</span> y considere la variable <span class="math inline">\(\delta\)</span> que asume el valor <span class="math inline">\(i\)</span> si <span class="math inline">\(T=X_i\)</span>. Definimos la tasa del riesgo <span class="math inline">\(i\)</span>-ésimo como:</p>
<span class="math display">\[\begin{align*}
   h_i(t)&amp;=\lim_{\Delta t\rightarrow 0}\frac{P[t\leq T &lt; t+\Delta t, \delta=i|T\geq t]}{\Delta t}\\
   &amp;=\lim_{\Delta t\rightarrow 0}\frac{P[t\leq X_i &lt; t+\Delta t|X_j\geq t, \quad j=1,\ldots,K]}{\Delta t}
\end{align*}\]</span>
<p>Entonces, si <span class="math inline">\(S(t_1,\ldots,t_K)=P[X_1&gt;t_1,\ldots,X_K&gt;t_K]\)</span></p>
<span class="math display">\[\begin{align*}
   h_T(t)=\sum_{i=1}^Kh_i(t) \quad \text{y} \quad h_i(t)=\frac{-\frac{\delta}{\delta t_i}S(t_1,\ldots,t_k)|_{t_1=\cdots=t_K=t}}{S(t,\ldots,t)}
\end{align*}\]</span>
<p><strong>Caso especial</strong>: si los <span class="math inline">\(K\)</span> riesgos en competencia son independientes:</p>
<p><span class="math display">\[h_i(t)=\frac{-\frac{\delta}{\delta t_i}\prod_{j=1}^KS_j(t_j)|_{t_1=\cdots=t_K=t}}{\prod_{j=1}^KS_j(t)}=\frac{-\frac{\delta}{\delta t_i}S_i(t_i)|_{t_i=t}}{S_i(t)}\]</span></p>
<p>En el caso no independiente (ver Ejemplo 2.7 del Klein).</p>
<p><strong>Nota</strong>: es fundamental hacer algún supuesto sobre la estructura de dependencia en los tiempos de fallo, ya que al acontecer el riesgo en una causa especifica no se observó el tiempo de fallo en los riesgos restantes.</p>
<p>En el contexto de riesgos en competencia, no siempre se utiliza la tasas de riesgo para sintetizar la información, sino que también se utiliza probabilidades con distinta interpretación:</p>
<ol type="1">
<li><em>Probabilidades crudas</em>: probabilidad de muerte de un individuo bajo una causa en particular, cuando el resto de las causas también influyen en el comportamiento de sobrevivencia del individuo.</li>
</ol>
<p>Se calculan a través de la función de incidencia acumulativa:</p>
<span class="math display">\[\begin{align*}
   F_i(t)&amp;=P[T\leq t, \delta = i]\\
   &amp;=\int_0^th_i(u)\exp[-H_T(u)]du
\end{align*}\]</span>
<p>donde el último término exponencial es la tasa acumulativa de todos los riesgos en competencia. Note que <span class="math inline">\(F_i\)</span> no es una distribución ya que:</p>
<p><span class="math display">\[F_i(\infty)=P[\delta = i]\neq 1\]</span></p>
<p>Al aplicar la función <span class="math inline">\(F_i\)</span> se puede calcular las probabilidades crudas directamente.</p>
<ol start="2" type="1">
<li><em>Probabilidades netas</em>: Probabilidad de muerte de un individuo donde la causa de muerte o riesgo de interés es el único. Usando la notación:</li>
</ol>
<p><span class="math display">\[S_i(t)=S(0,\ldots,0,\stackrel{\text{posicion }i}{t},0,\ldots,0)\]</span></p>
<p>En el caso independiente:</p>
<span class="math display">\[\begin{align*}
   S_i(t)&amp;=\exp(0)\cdots \exp\left(-\int_0^th_i(u)du\right)\cdots \exp(0)\\
   &amp;=\exp\left[-\int_0^t\frac{dF_i(u)}{S_T(u)}du\right]
\end{align*}\]</span>
<ol start="3" type="1">
<li><em>Probabilidades parciales crudas</em>: Probabilidades de muerte en un contexto en donde algunos riesgos han sido eliminados. Sean <span class="math inline">\(J\)</span>: conjunto de causas o riesgos de interés. Defina:</li>
</ol>
<p><span class="math display">\[T^J=\min(X_i,i\in J)\quad \text{y} \quad F_i^J(t)=P[T^J\leq t,\delta=i]\]</span></p>
<p>para <span class="math inline">\(i \in J\)</span>. Definimos la tasa de riesgo cruda parcial:</p>
<p><span class="math display">\[\lambda_i^J=\frac{-\frac{\delta S(t_1,\ldots,t_K)}{\delta t_i}\Big \vert_{t_j=t, j\in J; t_j=0, j\in J^C}}{S(t_1,\ldots,t_K)\Big \vert_{t_j=t, j\in J; t_j=0, j\in J^C}}\]</span></p>
<p>Entonces:</p>
<p><span class="math display">\[F_i^J(t)=P[T^J\leq t, \delta=i]=\int_0^t\lambda^J_i(x)\exp\left[-\sum_{j\in J}\int_0^t\lambda_j^J(u)du\right]dx\]</span></p>
<p>Note que en el caso independiente, la tasa de riesgo cruda parcial es:</p>
<p><span class="math display">\[\lambda_i^J(t)=\frac{dF_i(t)/dt}{S_T(t)}\]</span></p>
</section>
<section id="censura-y-truncamiento" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="censura-y-truncamiento"><span class="header-section-number">1.5</span> Censura y Truncamiento</h2>
<p>Conceptos de censura y truncamiento:</p>
<div id="def-censura" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.5 (Censura) </strong></span>Información de sobrevivencia de un individuo, que solamente se conoce con respecto a un intervalo y no a un punto fijo de occurrencia del evento de riesgo.</p>
</div>
<div id="def-truncamiento" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.6 (Truncamiento) </strong></span>Restricción de entrada o salida a un estudio de sobrevivencia.</p>
</div>
<section id="censura-por-la-derecha" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="censura-por-la-derecha"><span class="header-section-number">1.5.1</span> Censura por la derecha</h3>
<p>También conocida como Censura Tipo I:</p>
<div id="def-censuraI" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.7 (Censura Tipo I) </strong></span>Evento de interés es observado solamente si ocurre antes de un tiempo específico.</p>
</div>
<p>Recordando la notación que hemos usando hasta el momento, si <span class="math inline">\(X\)</span> es el tiempo aleatorio en que ocurre el riesgo, <span class="math inline">\(X\sim f(x)\)</span> con función de sobrevivencia <span class="math inline">\(S(x)\)</span> y además <span class="math inline">\(C_r\)</span> denota el tiempo de censura fijo, entonces <span class="math inline">\(X\)</span> es observado solamente si <span class="math inline">\(X\leq C_r\)</span> y si <span class="math inline">\(X&gt;C_r\)</span> decimos que el evento es “censurado”.</p>
<p>En este caso los datos pueden ser representados en pares:</p>
<p><span class="math display">\[(T,\delta)\]</span></p>
<p>donde <span class="math inline">\(\delta=1\)</span> indica que el evento se observa y <span class="math inline">\(\delta=0\)</span> indica que el evento es censurado. Además <span class="math inline">\(T=\min(X,C_r)\)</span>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Ejemplo de Censura
</div>
</div>
<div class="callout-body-container callout-body">
<p>En un estudio clínico, hay una serie de ratones alimentados con un agente cancerígeno. Se rastrea el tiempo de vida en cada ratón, hasta la muerte o bien hasta una censura pre-establecida (sacrificio):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/CensuraI.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Censura Tipo I</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>También se puede dar el caso de que el tiempo de censura entre observaciones no sea único (censura progresiva):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/CensuraI_prog.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Censura Tipo I-progresiva</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>También se puede dar el caso de que no todos los sujetos de prueba (ratones) estuvieron al inicio del estudio (Censura Tipo I-generalizada):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/CensuraI_gene.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Censura Tipo I-generalizada</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Otra forma de representar los tiempos de sobrevivencia y censura en una muestra es a través de un <em>Diagrama de Lexis</em>, en donde se representa en el eje x el tiempo transcurrido (calendario) del estudio y en el eje y el tiempo transcurrido de cualquier individuo en el estudio:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/CensuraI_lexis.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Diagrama de Lexis</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Otro tipo de esquema de censura por la derecha es la <em>Censura Tipo II</em>: en donde un estudio termina cuando fallan los primeros <span class="math inline">\(r\)</span> individuos en un grupo de <span class="math inline">\(n\)</span> individuos. Este tipo de esquema se suele aplicar en lotes de equipo electrónico por ejemplo o sistemas que están conectados en red. En este caso <span class="math inline">\(r\)</span>: número de fallos, <span class="math inline">\(n-r\)</span>: número de censuras y <span class="math inline">\(T_{(r)}\)</span>: tiempo de censura del estudio.</p>
<p>También se puede utilizar un esquema progresivo para la censura tipo II. Suponga que hay <span class="math inline">\(r_1\)</span> fallos de un total de <span class="math inline">\(n\)</span> individuos. Además asuma que se censuran <span class="math inline">\(n_1-r_1\)</span> individuos (<span class="math inline">\(n_1&lt;n\)</span>) con un primer tiempo de censura <span class="math inline">\(T_{(r_1)}\)</span>. El proceso puede continuar con los <span class="math inline">\(n-n_1\)</span> individuos restantes, ocurre <span class="math inline">\(r_2\)</span> fallos (<span class="math inline">\(r_2&lt;n-n_1\)</span>), <span class="math inline">\(n_2-r_2\)</span> censuras (<span class="math inline">\(n_1+n_2&lt;n\)</span>) y <span class="math inline">\(T_{(n_1+r_2)}\)</span> es el segundo tiempo de censura y así sucesivamente.</p>
</section>
<section id="censura-por-la-izquierda-o-de-intervalo" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="censura-por-la-izquierda-o-de-intervalo"><span class="header-section-number">1.5.2</span> Censura por la izquierda o de intervalo</h3>
<p>Suponga que para un tiempo de vida <span class="math inline">\(X\)</span> existe un tiempo <span class="math inline">\(C_\ell\)</span> en donde el evento de riesgo ocurrió antes de que el sujeto fuera observado. En este caso el tiempo <span class="math inline">\(X\)</span> es observado si <span class="math inline">\(X&gt;C_\ell\)</span>. Al igual que en el caso de censura por la derecha, podemos usar la notación:</p>
<p><span class="math display">\[(T,\epsilon)\]</span></p>
<p>donde <span class="math inline">\(T=X\)</span> si <span class="math inline">\(\epsilon=1\)</span> (observado) y <span class="math inline">\(T=C_\ell\)</span> si <span class="math inline">\(\epsilon=0\)</span> (censurado), es decir <span class="math inline">\(T=\max(X,C_\ell)\)</span>. Por ejemplo, si un estudio busca cuantificar el riesgo de fumar marihuana por primera vez <span class="citation" data-cites="Klein2003a">(<a href="references.html#ref-Klein2003a" role="doc-biblioref">Klein and Moeschberger 2003</a>)</span>, un individuo tendría una censura por la izquierda si no recuerda la primera vez que fumó, pero afirma que sí la ha consumido antes del inicio del estudio.</p>
<p>Si por otro lado se combina la censura por la derecha y por la izquierda, se denomina <em>censura doble</em>, y en este caso los datos son:</p>
<p><span class="math display">\[(T,\delta)\quad \text{donde} \quad T=\max\left(\min(X,C_r),C_\ell\right)\]</span></p>
<p>y</p>
<span class="math display">\[\begin{align*}
\delta=\begin{cases}
1 &amp; \text{si $T$ ocurre entre $C_\ell$ y $C_r$}\\
0 &amp; \text{censura por la derecha}\\
-1 &amp; \text{censura por la izquierda}
\end{cases}
\end{align*}\]</span>
<p>Finalmente, la <em>censura por intervalo</em> se utiliza en estudios en donde un paciente o individuo en general es visitado periódicamente y lo único que se sabe es que el evento de interés ocurrió en un intervalo <span class="math inline">\((L_i,R_i]\)</span> cuyos extremos corresponde a los momentos de visitas consecutivas.</p>
</section>
<section id="truncamiento-1" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="truncamiento-1"><span class="header-section-number">1.5.3</span> Truncamiento</h3>
<p>El truncamiento ocurre cuando en un estudio solamente se incluyen y observan individuos cuyos eventos ocurren en <span class="math inline">\((Y_L,Y_R)\)</span>. Si el evento ocurriera fuera de ese intervalo entonces no se incluye en el estudio.</p>
<p>Si <span class="math inline">\(Y_R=\infty\)</span> entonces X es observado <span class="math inline">\(\Leftrightarrow Y_L&lt;X\)</span> (<em>truncamiento por la izquierda</em>). Por ejemplo: (1) si se estudia la aparición de una enfermedad desde una fecha fija o (2) si se estudia el evento de muerte desde el inicio de un estudio clínico.</p>
<p><strong>Nota</strong>: Muchas veces el truncamiento por la izquierda es acompañado con censura por la derecha.</p>
<p>Para el caso de truncamiento por la derecha: si <span class="math inline">\(Y_L=0\)</span>: <span class="math inline">\(X\)</span> es observado <span class="math inline">\(\Leftrightarrow X\leq Y_R\)</span> (ver Ejemplo 3.8 del <span class="citation" data-cites="Klein2003a">(<a href="references.html#ref-Klein2003a" role="doc-biblioref">Klein and Moeschberger 2003</a>)</span>).</p>
</section>
</section>
<section id="verosimilitud-bajo-censura-y-truncamiento" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="verosimilitud-bajo-censura-y-truncamiento"><span class="header-section-number">1.6</span> Verosimilitud bajo censura y truncamiento</h2>
<p>Supuesto: tiempos de ocurrencia de evento y tiempos de censura son independientes. Cada tipo de censura/truncamiento aporta distintos factores a la verosimilitud completa de los datos:</p>
<ul>
<li><p>Tiempo exacto del evento en estudio: <span class="math inline">\(f(x)\)</span></p></li>
<li><p>Censura por la derecha: <span class="math inline">\(P(X&gt;C_r)=S(C_r)\)</span></p></li>
<li><p>Censura por la izquierda: <span class="math inline">\(P(X&lt;C_\ell)=1-S(C_\ell)\)</span></p></li>
<li><p>Censura en intervalo: <span class="math inline">\(P(L&lt;X&lt;R)=S(L)-S(R)\)</span></p></li>
<li><p>Truncamiento por la izquierda: <span class="math inline">\(f(x|X&gt;Y_L)=\frac{f(x)}{S(Y_L)}\)</span></p></li>
<li><p>Truncamiento por la derecha: <span class="math inline">\(f(x|X&lt;Y_R)=\frac{f(x)}{1-S(Y_R)}\)</span></p></li>
</ul>
<p>Por lo tanto la verosimilitud con datos censurados se puede escribir como:</p>
<p><span class="math display">\[L\propto \prod_{i \in D}f(x_i)\prod_{i \in R}S(C_r)\prod_{i \in L}\left(1-S(C_\ell)\right) \prod_{i \in I}[S(L_i)-S(R_i)]\]</span></p>
<p>donde</p>
<ul>
<li><p><span class="math inline">\(D\)</span>: conjunto de eventos observables.</p></li>
<li><p><span class="math inline">\(R\)</span>: conjunto de observaciones con censura por la derecha.</p></li>
<li><p><span class="math inline">\(L\)</span>: conjunto de observaciones con censura por la izquierda.</p></li>
<li><p><span class="math inline">\(I\)</span>: conjunto de observaciones con censura por intervalo.</p></li>
</ul>
<p>Para datos truncados por la izquierda y censurados por la derecha con intervalo de truncamiento <span class="math inline">\((Y_{L_i},Y_{R_i})\)</span> independientes del <span class="math inline">\(i\)</span>-ésimo momento de muerte, se reemplaza <span class="math inline">\(f(x_i)\)</span> y <span class="math inline">\(S(C_i)\)</span> (<span class="math inline">\(C_i\)</span>: tiempo de censura <span class="math inline">\(i\)</span>-ésima) por:</p>
<p><span class="math display">\[\frac{f(x_i)}{S(Y_{L_i})-S(Y_{R_i})} \quad \text{y} \quad \frac{S(C_i)}{S(Y_{L_i})-S(Y_{R_i})}\]</span></p>
<p>En el caso en donde cada individuo tiene una distribución de riesgo distinta (Ejemplo: regresión):</p>
<p><span class="math display">\[L\propto \prod_{i \in D}f_i(x_i)\prod_{i \in R}S_i(C_r)\prod_{i \in L}\left(1-S_i(C_\ell)\right) \prod_{i \in I}[S_i(L_i)-S_i(R_i)]\]</span></p>
<p><strong>Caso particular</strong>: censura tipo I (por la derecha)</p>
<p>Si <span class="math inline">\(\delta=0\)</span> (censura):</p>
<span class="math display">\[\begin{align*}
   P[T,\delta=0]&amp;=P[T=C_r|\delta=0]P[\delta=0]=P[\delta=0]\\
   &amp;=P[X&gt;C_r]=S(C_r).
\end{align*}\]</span>
<p>Si <span class="math inline">\(\delta = 1\)</span>:</p>
<span class="math display">\[\begin{align*}
   P[T,\delta=1]&amp;=P[T=X|\delta=1]P[\delta=1]\\
   &amp;=P[T=X|X\leq C_r]P[X\leq C_r]\\
   &amp;=\frac{f(t)}{1-S(C_r)}[1-S(C_r)]=f(t).
\end{align*}\]</span>
<p>Entonces el aporte de <span class="math inline">\(T=t\)</span> a la verosimilitud es:</p>
<p><span class="math display">\[[f(t)]^\delta[S(t)]^{1-\delta}\]</span></p>
<p>Si se tiene una muestra aleatoria de pares <span class="math inline">\((T_i,\delta_i)\)</span>, para <span class="math inline">\(i=1,\ldots,n\)</span>:</p>
<p><span class="math display">\[L=\prod_{i=1}^nf(t_i)^{\delta_i}[S(t_i)]^{1-\delta_i}\]</span></p>
<p>Como <span class="math inline">\(f(t_i)=h(t_i)S(t_i)\)</span> entonces:</p>
<p><span class="math display">\[L=\prod_{i=1}^nh(t_i)^{\delta_i}S(t_i)^{\delta_i}[S(t_i)]^{1-\delta_i}=\prod_{i=1}^nh(t_i)^{\delta_i}\exp(-H(t_i))\]</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ejemplo: Caso Exponencial
</div>
</div>
<div class="callout-body-container callout-body">
<p>Asuma que <span class="math inline">\(X\sim \text{Exponencial}(\lambda)\)</span> con <span class="math inline">\(f(x)=\lambda \exp(-\lambda x)\)</span>, entonces:</p>
<span class="math display">\[\begin{align*}
   L&amp;=\prod_{i=1}^n [\lambda \exp(-\lambda t_i)]^{\delta_i}[\exp(-\lambda t_i)]^{(1-\delta_i)}\\
   &amp;=\lambda^r\exp(-\lambda S_T)
\end{align*}\]</span>
<p>donde <span class="math inline">\(r=\sum \delta_i\)</span> (total de eventos observados) y <span class="math inline">\(S_T=\sum_{i=1}^n t_i\)</span> (total de tiempo en el estudio).</p>
</div>
</div>
</section>
<section id="laboratorio" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="laboratorio"><span class="header-section-number">1.7</span> Laboratorio</h2>
<section id="ejemplos-de-datos-de-análisis-de-sobrevivencia" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="ejemplos-de-datos-de-análisis-de-sobrevivencia"><span class="header-section-number">1.7.1</span> Ejemplos de datos de análisis de sobrevivencia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(KMsurv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="ejemplo-1" class="level4" data-number="1.7.1.1">
<h4 data-number="1.7.1.1" class="anchored" data-anchor-id="ejemplo-1"><span class="header-section-number">1.7.1.1</span> Ejemplo 1</h4>
<p>Ensayo clínico de un fármaco, 6-mercaptopurina (6-MP), frente a un placebo en 42 niños con leucemia aguda. El ensayo se llevó a cabo en 11 hospitales estadounidenses. Se seleccionaron pacientes que habían experimentado una remisión completa o parcial de su leucemia inducida por el tratamiento con el fármaco prednisona. (Una remisión completa o parcial significa que la mayoría o todos los signos de la enfermedad habían desaparecido de la médula ósea). El ensayo se realizó emparejando pares de pacientes en un hospital determinado por estado de remisión (completa o parcial) y aleatorizando dentro del par para recibir terapia de mantenimiento con 6-MP o placebo. Los pacientes fueron seguidos hasta que su leucemia regresó (relapse) o hasta el final del estudio (en meses).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"drug6mp"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#help("drug6mp")</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(drug6mp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 21
Columns: 5
$ pair    &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…
$ remstat &lt;int&gt; 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2
$ t1      &lt;int&gt; 1, 22, 3, 12, 8, 17, 2, 11, 8, 12, 2, 5, 4, 15, 8, 23, 5, 11, …
$ t2      &lt;int&gt; 10, 7, 32, 23, 22, 6, 16, 34, 32, 25, 11, 20, 19, 6, 17, 35, 6…
$ relapse &lt;int&gt; 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">data =</span> drug6mp,<span class="at">mapping =</span> <span class="fu">aes</span>(t2),<span class="at">bins =</span> <span class="dv">6</span>,<span class="at">fill=</span><span class="st">'white'</span>,<span class="at">col =</span> <span class="st">'black'</span>)<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(drug6mp<span class="sc">$</span>relapse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1 
12  9 </code></pre>
</div>
</div>
</section>
<section id="ejemplo-2" class="level4" data-number="1.7.1.2">
<h4 data-number="1.7.1.2" class="anchored" data-anchor-id="ejemplo-2"><span class="header-section-number">1.7.1.2</span> Ejemplo 2</h4>
<p>Evaluación del tiempo hasta la primera infección del sitio de salida (en meses) en pacientes con insuficiencia renal, 43 pacientes utilizaron un catéter colocado quirúrgicamente (Grupo 1), y 76 pacientes utilizaron una colocación percutánea de su catéter (Grupo 2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(kidney)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#help(kidney)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(kidney)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 119
Columns: 3
$ time  &lt;dbl&gt; 1.5, 3.5, 4.5, 4.5, 5.5, 8.5, 8.5, 9.5, 10.5, 11.5, 15.5, 16.5, …
$ delta &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0…
$ type  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">data =</span> kidney,<span class="at">mapping =</span> <span class="fu">aes</span>(time),<span class="at">bins =</span> <span class="dv">6</span>,<span class="at">fill=</span><span class="st">'white'</span>,<span class="at">col =</span> <span class="st">'black'</span>)<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kidney<span class="sc">$</span>delta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1 
93 26 </code></pre>
</div>
</div>
</section>
<section id="ejemplo-3" class="level4" data-number="1.7.1.3">
<h4 data-number="1.7.1.3" class="anchored" data-anchor-id="ejemplo-3"><span class="header-section-number">1.7.1.3</span> Ejemplo 3</h4>
<p>Estudio diseñado para determinar si las pacientes con cáncer de mama, clasificadas originalmente como negativas en los ganglios linfáticos por microscopía de luz estándar (SLM), podrían ser clasificadas de manera más precisa mediante examen inmunohistoquímico (IH) de sus ganglios linfáticos con un cóctel de anticuerpos monoclonales anticitokeratina. Se seleccionaron 45 pacientes con cáncer de mama femenino y ganglios linfáticos axilares negativos y un seguimiento mínimo de 10 años del Registro de Cáncer de los Hospitales de la Universidad Estatal de Ohio. De las 45 pacientes, 9 fueron positivas para inmunoperoxidasa, y las 36 restantes permanecieron negativas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(btrial)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#help(btrial)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(btrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 45
Columns: 3
$ time  &lt;int&gt; 19, 25, 30, 34, 37, 46, 47, 51, 56, 57, 61, 66, 67, 74, 78, 86, …
$ death &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0…
$ im    &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tabla_1 <span class="ot">&lt;-</span> btrial <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(death,im) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">round</span>(total <span class="sc">/</span> <span class="fu">sum</span>(total)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'death'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(tabla_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  death    im total
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     0     1 44.4 
2     0     2  2.22
3     1     1 35.6 
4     1     2 17.8 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tabla_2 <span class="ot">&lt;-</span> btrial <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(death,im) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">round</span>(<span class="fu">mean</span>(time),<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'death'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(tabla_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   death [2]
  death    im total
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     0     1 148. 
2     0     2 144  
3     1     1  52.1
4     1     2  59.9</code></pre>
</div>
</div>
</section>
<section id="ejemplo-4" class="level4" data-number="1.7.1.4">
<h4 data-number="1.7.1.4" class="anchored" data-anchor-id="ejemplo-4"><span class="header-section-number">1.7.1.4</span> Ejemplo 4</h4>
<p>Muestra de 101 pacientes con leucemia mieloide aguda avanzada reportados en el Registro Internacional de Trasplante de Médula Ósea. 51 de estos pacientes recibieron un trasplante autólogo de médula ósea en el que, después de altas dosis de quimioterapia, su propia médula fue reinfundida para reemplazar su sistema inmunológico destruido. 50 pacientes recibieron un trasplante alogénico de médula ósea en el que se utilizó médula de un hermano compatible en cuanto a antígenos leucocitarios humanos (HLA) para reponer sus sistemas inmunológicos. Una pregunta importante en el trasplante de médula ósea es la comparación de la efectividad de estos dos métodos de trasplante medida por la duración de la supervivencia libre de leucemia de los pacientes, el tiempo que viven y cuánto tiempo permanecen libres de enfermedad después de sus trasplantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"alloauto"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#help("alloauto")</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(alloauto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 101
Columns: 3
$ time  &lt;dbl&gt; 0.030, 0.493, 0.855, 1.184, 1.283, 1.480, 1.776, 2.138, 2.500, 2…
$ type  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ delta &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>alloauto <span class="ot">&lt;-</span> alloauto <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">data =</span> alloauto,<span class="fu">aes</span>(<span class="at">x =</span> time),<span class="at">bins =</span> <span class="dv">7</span>,<span class="at">fill=</span><span class="st">'white'</span>,<span class="at">col =</span> <span class="st">'black'</span>)<span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(type),<span class="at">nrow =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asaur)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gastricXelox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  timeWeeks delta
1         4     1
2         8     1
3         8     1
4         8     1
5         9     1
6        11     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gastricXelox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48  2</code></pre>
</div>
</div>
</section>
<section id="ejemplo-5" class="level4" data-number="1.7.1.5">
<h4 data-number="1.7.1.5" class="anchored" data-anchor-id="ejemplo-5"><span class="header-section-number">1.7.1.5</span> Ejemplo 5</h4>
<p>Este es un ensayo clínico de Fase II (muestra única) de quimioterapia Xeloda y oxaliplatino (XELOX) administrado antes de la cirugía a 48 pacientes con cáncer gástrico avanzado con metástasis en los ganglios linfáticos paraaórticos (Wang et al.).</p>
<ul>
<li><p><em>timeWeeks</em>: tiempo de sobrevivencia en semanas.</p></li>
<li><p><em>delta</em>: variable de censura: (1) muerte, (2) censura.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prostateSurvival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  grade stage ageGroup survTime status
1  mode   T1c      80+       18      0
2  mode  T1ab    75-79       23      0
3  poor   T1c    75-79       37      0
4  mode    T2    70-74       27      0
5  mode   T1c    70-74       42      0
6  poor    T2    75-79       38      2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(prostateSurvival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14294     5</code></pre>
</div>
</div>
</section>
<section id="ejemplo-6" class="level4" data-number="1.7.1.6">
<h4 data-number="1.7.1.6" class="anchored" data-anchor-id="ejemplo-6"><span class="header-section-number">1.7.1.6</span> Ejemplo 6</h4>
<p>Datos simulados de 14,294 pacientes con cáncer de próstata basados en análisis detallados de riesgos competitivos publicados por Lu-Yao et al.&nbsp;Para cada paciente, tenemos la clasificación histológica (poco o moderadamente diferenciado), la edad del diagnóstico (66-70, 71-75, 76-80 y 80+), el estadio del cáncer (T1c si se diagnosticó mediante una prueba de detección de antígeno específico de próstata, T1ab si se diagnosticó clínicamente sin cribado, o T2 si fue palpable en el momento del diagnóstico), el tiempo de supervivencia (días desde el diagnóstico hasta la muerte o la última fecha de seguimiento) y un indicador (“estado”) que indica si el paciente murió de cáncer de próstata (estado = 1), murió de otra causa (estado = 2) o seguía vivo en la última fecha de seguimiento (estado = 0).</p>
<ul>
<li><p><em>ageGroup</em>: edad de diagnóstico.</p></li>
<li><p><em>stage</em>: etapa del cáncer.</p></li>
<li><p><em>survTime</em>: tiempo de sobrevivencia.</p></li>
<li><p><em>status</em>: Muerte por cáncer de próstata (1), muerte por otra causa (2), sobrevivencia al final del estudio (0).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pharmacoSmoking)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id ttr relapse         grp age gender     race employment yearsSmoking
1  21 182       0   patchOnly  36   Male    white         ft           26
2 113  14       1   patchOnly  41   Male    white      other           27
3  39   5       1 combination  25 Female    white      other           12
4  80  16       1 combination  54   Male    white         ft           39
5  87   0       1 combination  45   Male    white      other           30
6  29 182       0 combination  43   Male hispanic         ft           30
  levelSmoking ageGroup2 ageGroup4 priorAttempts longestNoSmoke
1        heavy     21-49     35-49             0              0
2        heavy     21-49     35-49             3             90
3        heavy     21-49     21-34             3             21
4        heavy       50+     50-64             0              0
5        heavy     21-49     35-49             0              0
6        heavy     21-49     35-49             2           1825</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pharmacoSmoking)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 125  14</code></pre>
</div>
</div>
</section>
<section id="ejemplo-7" class="level4" data-number="1.7.1.7">
<h4 data-number="1.7.1.7" class="anchored" data-anchor-id="ejemplo-7"><span class="header-section-number">1.7.1.7</span> Ejemplo 7</h4>
<p>El propósito de este estudio (Steinberg et al.&nbsp;[63]) fue evaluar la duración prolongada de una combinación de tres medicamentos versus la terapia con parche de nicotina sola en fumadores con enfermedades médicas. Los pacientes con antecedentes de tabaquismo fueron asignados al azar a la combinación de tres medicamentos o a la terapia con parche, y se siguieron durante un máximo de seis meses. La variable de resultado primaria fue el tiempo desde la asignación aleatoria hasta la recaída (vuelta al tabaquismo); las personas que permanecieron sin fumar durante seis meses fueron censuradas.</p>
<ul>
<li><p><em>ttr</em>: tiempo en dias hasta una recaída (volver a fumar).</p></li>
<li><p><em>relapse</em>: (1): volvió a fumar vs (0): censura.</p></li>
<li><p><em>employment</em>: jornada laboral.</p></li>
</ul>
</section>
<section id="ejemplo-8" class="level4" data-number="1.7.1.8">
<h4 data-number="1.7.1.8" class="anchored" data-anchor-id="ejemplo-8"><span class="header-section-number">1.7.1.8</span> Ejemplo 8</h4>
<p>Tasas de riesgo (Tablas de vida en USA) expresadas por día calendario:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survival'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked _by_ '.GlobalEnv':

    kidney</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(survexp.us)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 110   2  75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>hazMale <span class="ot">&lt;-</span> survexp.us[,<span class="st">"male"</span>,<span class="st">"2010"</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>hazFemale <span class="ot">&lt;-</span> survexp.us[,<span class="st">"female"</span>,<span class="st">"2010"</span>]</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">110</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>tm.diff <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">diff</span>(tm))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>survMale <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">cumsum</span>(hazMale<span class="sc">*</span>tm.diff)<span class="sc">*</span><span class="fl">365.24</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>survFemale <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">cumsum</span>(hazFemale <span class="sc">*</span>tm.diff)<span class="sc">*</span><span class="fl">365.24</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>data.tot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tm,<span class="at">hMale =</span> <span class="fu">as.numeric</span>(hazMale),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">hFemale =</span> <span class="fu">as.numeric</span>(hazFemale),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sMale =</span> survMale, <span class="at">sFemale =</span> survFemale)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>data.tot.long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(data.tot,<span class="at">cols =</span> hMale<span class="sc">:</span>sFemale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grafico de tasas de riesgo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data.tot.long.h <span class="ot">&lt;-</span> data.tot.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">'hMale'</span> <span class="sc">|</span> name <span class="sc">==</span> <span class="st">'hFemale'</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.tot.long.h)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> tm,<span class="at">y =</span> value,<span class="at">col =</span> name)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">'Age'</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">'Hazard'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Grafico de probabilidades de sobrevivencia:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>data.tot.long.s <span class="ot">&lt;-</span> data.tot.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">'sMale'</span> <span class="sc">|</span> name <span class="sc">==</span> <span class="st">'sFemale'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data.tot.long.s)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> tm,<span class="at">y =</span> value,<span class="at">col =</span> name)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">'Age'</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">'Hazard'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Preliminares_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Klein2003a" class="csl-entry" role="doc-biblioentry">
Klein, John P., and Melvin L. Moeschberger. 2003. <em><span class="nocase">Survival analysis : techniques for censored and truncated data</span></em>. Springer.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introducción</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./estNP.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimación No-Paramétrica</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>