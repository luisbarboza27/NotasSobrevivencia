<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de Sobrevivencia - 3&nbsp; Pruebas de Hipótesis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./estNP.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pruebas de Hipótesis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis de Sobrevivencia</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preliminares.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estNP.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimación No-Paramétrica</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PH.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pruebas de Hipótesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Referencias</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pruebas-de-hipótesis-de-una-muestra" id="toc-pruebas-de-hipótesis-de-una-muestra" class="nav-link active" data-scroll-target="#pruebas-de-hipótesis-de-una-muestra"><span class="toc-section-number">3.1</span>  Pruebas de Hipótesis de una muestra</a></li>
  <li><a href="#pruebas-de-hipótesis-para-más-de-una-muestra" id="toc-pruebas-de-hipótesis-para-más-de-una-muestra" class="nav-link" data-scroll-target="#pruebas-de-hipótesis-para-más-de-una-muestra"><span class="toc-section-number">3.2</span>  Pruebas de Hipótesis para más de una muestra</a></li>
  <li><a href="#pruebas-de-tendencia" id="toc-pruebas-de-tendencia" class="nav-link" data-scroll-target="#pruebas-de-tendencia"><span class="toc-section-number">3.3</span>  Pruebas de tendencia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="PH" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Pruebas de Hipótesis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pruebas-de-hipótesis-de-una-muestra" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="pruebas-de-hipótesis-de-una-muestra"><span class="header-section-number">3.1</span> Pruebas de Hipótesis de una muestra</h2>
<p>Supongamos una muestra con censura de tamaño <span class="math inline">\(n\)</span>. Se quiere probar las siguientes hipótesis:</p>
<ul>
<li><span class="math inline">\(H_0:\)</span> La tasa de riesgo de la población es <span class="math inline">\(h_0(t)\)</span> para todo <span class="math inline">\(t \leq \tau\)</span>.</li>
<li><span class="math inline">\(H_1:\)</span> La tasa de riesgo de la población es distinta a <span class="math inline">\(h_0(t)\)</span> para algún <span class="math inline">\(t \leq \tau\)</span>.</li>
</ul>
<p>Donde <span class="math inline">\(h_0(t)\)</span> es una tasa de riesgo conocida en <span class="math inline">\([0,\tau]\)</span> y <span class="math inline">\(\tau\)</span>: máximo de los tiempo de estudio observados.</p>
<p>Considere el estimador de Nelson-Aalen de <span class="math inline">\(H(t)\)</span>:</p>
<p><span class="math display">\[\hat H(t)=\sum_{t_i\leq t}\frac{d_i}{Y(t_i)}\]</span> donde <span class="math inline">\(d_i:\)</span> número de eventos en los tiempos observados <span class="math inline">\(t_1&lt;t_2&lt;\cdots &lt; t_D\)</span> y <span class="math inline">\(Y(t_i)\)</span>: número de individuos en riesgo al tiempo <span class="math inline">\(t_i\)</span>. Un estimador (muy crudo) de <span class="math inline">\(h(t_i)\)</span> es</p>
<p><span class="math display">\[\frac{d_i}{Y(t_i)}\]</span></p>
<p>y este estadístico nos permite definir un estadístico de prueba que busca comparar las tasas de riesgo observadas y esperadas usado diferencias ponderadas. Sea <span class="math inline">\(W(t)\)</span>: función de pesos tal que <span class="math inline">\(W(t)=0\)</span> si <span class="math inline">\(Y(t)=0\)</span>. Defina el siguiente estadístico de prueba:</p>
<p><span class="math display">\[Z(\tau)=O(\tau)-E(\tau)=\sum_{i=1}^DW(t_i)\frac{d_i}{Y(t_i)}-\int_0^\tau W(s)h_0(s)ds\]</span> Bajo <span class="math inline">\(H_0\)</span>, la varianza de <span class="math inline">\(Z(\tau)\)</span> es:</p>
<p><span class="math display">\[V[Z(\tau)]=\int_0^\tau W^2(s)\frac{h_0(s)}{Y(s)}ds\]</span> Si <span class="math inline">\(n\)</span> es grande:</p>
<p><span class="math display">\[\frac{Z(\tau)^2}{V[Z(\tau)]}\underset{H_0}{\sim}\chi_1^2\]</span> Por lo tanto se rechaza <span class="math inline">\(H_0\)</span> si <span class="math inline">\(\frac{Z(\tau)^2}{V[Z(\tau)]}&gt;\chi_{1,1-\alpha}^2\)</span> bajo un nivel de significancia de <span class="math inline">\(\alpha\)</span>.</p>
<p>Si se quiere probar <span class="math inline">\(H_0: h(t)&gt;h_0(t)\)</span> entonces se rechaza <span class="math inline">\(H_0\)</span> si:</p>
<p><span class="math display">\[\frac{Z(\tau)}{\sqrt{V[Z(\tau)]}}&gt;z_{1-\alpha}\]</span> con nivel <span class="math inline">\(\alpha\)</span>. La función de pesos se puede seleccionar de muchas formas, por ejemplo la forma más usual es (<em>Gehan</em>):</p>
<p><span class="math display">\[W(t)=Y(t)\]</span> con lo cual se genera una <em>prueba de rango</em> (Prueba de bondad de ajuste no-paramétrica). Otros casos: (<em>Harrington-Fleming</em>):</p>
<p><span class="math display">\[W(t)=Y(t)S_0(t)^p[1-S_0(t)]^q, \qquad p,q\geq 0\]</span> y <span class="math inline">\(S_0(t)=\exp[-H_0(t)]\)</span>.</p>
<p>En el caso de truncamiento por la izquierda, sea:</p>
<ul>
<li><span class="math inline">\(T_j\)</span>: tiempo de ocurrencia del evento en el <span class="math inline">\(j\)</span>-ésimo paciente.</li>
<li><span class="math inline">\(L_j\)</span>: tiempo de truncamiento por la izquierda en el <span class="math inline">\(j\)</span>-ésimo paciente. Este tiempo se puede interpretar como el momento de entrada en el estudio.</li>
</ul>
<p>Si se usa la opción <span class="math inline">\(W(t)=Y(t)\)</span>, entonces:</p>
<p><span class="math display">\[O(\tau)=\sum_{i=1}^D d_i\]</span></p>
<p>y</p>
<p><span class="math display">\[E(\tau)=\int_0^\tau Y(s)h_0(s)ds = V[Z(\tau)]=\sum_{j=1}^n H_0(T_j)-H_0(L_j)\]</span></p>
</section>
<section id="pruebas-de-hipótesis-para-más-de-una-muestra" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="pruebas-de-hipótesis-para-más-de-una-muestra"><span class="header-section-number">3.2</span> Pruebas de Hipótesis para más de una muestra</h2>
<p>Queremos probar las siguientes alternativas:</p>
<ul>
<li><span class="math inline">\(H_0: h_1(t)=h_2(t)=\cdots=h_k(t)\)</span> para todo <span class="math inline">\(t\leq \tau\)</span></li>
<li><span class="math inline">\(H_1\)</span>: al menos uno de los <span class="math inline">\(h_j(t)\)</span> es diferente para algún <span class="math inline">\(t\leq \tau\)</span>.</li>
</ul>
<p>Sea <span class="math inline">\(\tau\)</span>: tiempo máximo en donde todos los grupos tienen al menos un individuo en riesgo. Normalmente <span class="math inline">\(\tau=\min_k \{\max \{ \text{tiempos de estudio}\}\}\)</span>.</p>
<p>Los datos en este caso constituyen muestras independientes de datos censurados, truncados por la izquierda para cada una de las <span class="math inline">\(k\)</span> poblaciones. Sea <span class="math inline">\(t_1&lt;t_2&lt;\cdots &lt;t_D\)</span> los distintos tiempos de ocurrencia del evento de interés en la muestra combinada.</p>
<p>En tiempo <span class="math inline">\(t_i\)</span> se observa <span class="math inline">\(d_{ij}\)</span> eventos en la <span class="math inline">\(j\)</span>-ésima muestra con <span class="math inline">\(Y_{ij}\)</span>: individuos en riesgo de la población <span class="math inline">\(j\)</span>-ésima (<span class="math inline">\(j=1,\ldots,k\)</span>, <span class="math inline">\(i=1,\ldots,D\)</span>).</p>
<p>Además:</p>
<p><span class="math display">\[d_i=\sum_{j=1}^k d_{ij}\qquad \text{y} \qquad Y_i=\sum_{j=1}^k Y_{ij}\]</span> Si <span class="math inline">\(H_0\)</span> es cierto, un estimador de la tasa de riesgo para la población <span class="math inline">\(j\)</span>-ésima es el estimador combinado:</p>
<p><span class="math display">\[\frac{d_i}{Y_i}\]</span></p>
<p>Si <span class="math inline">\(W_j(t_i)\)</span> denota una función de pesos tal que es cero si <span class="math inline">\(Y_{ij}=0\)</span>, entonces defina el estadístico:</p>
<p><span class="math display">\[Z_j(\tau)=\sum_{j=1}^D W_j(t_i)\left[\frac{d_{ij}}{Y_{ij}}-\frac{d_i}{Y_i}\right]\]</span> Interpretación del estadístico <span class="math inline">\(Z_j(\tau)\)</span>: valores altos dan evidencia de que <span class="math inline">\(H_0\)</span> no es cierto.</p>
<p>En general, se simplifica la ponderación de <span class="math inline">\(Z_j\)</span> al escoger:</p>
<p><span class="math display">\[W_j(t_i)=Y_{ij}W(t_i)\]</span> en donde <span class="math inline">\(W(t_i)\)</span> es un peso en común para toda la muestra combinada. En este caso la diferencia ponderada quedaría:</p>
<p><span class="math display">\[Z_j(\tau)=\sum_{i=1}^D W(t_i)\left[d_{ij}-\underbrace{Y_{ij}\left(\frac{d_i}{Y_i}\right)}_{**}\right]\]</span> donde <span class="math inline">\(**\)</span> es el número de eventos esperados bajo <span class="math inline">\(H_0\)</span>. La varianza de <span class="math inline">\(Z_j(\tau)\)</span> es:</p>
<p><span class="math display">\[\hat \sigma_{jj}=\sum_{i=1}^D W(t_i)^2\frac{Y_{ij}}{Y_i}\left(1-\frac{Y_{ij}}{Y_i}\right)\left(\frac{Y_i-d_i}{Y_i-1}\right)d_i\]</span> para <span class="math inline">\(j=1,\ldots,k\)</span>. La covarianza entre <span class="math inline">\(Z_j(\tau)\)</span> y <span class="math inline">\(Z_g(\tau)\)</span> es:</p>
<p><span class="math display">\[\hat \sigma_{jg}=-\sum_{i=1}^D W(t_i)^2\frac{Y_{ij}}{Y_i}\frac{Y_{ig}}{Y_i}\left(\frac{Y_i-d_i}{Y_i-1}\right)d_i\]</span> El término <span class="math inline">\(\frac{Y_i-d_i}{Y_i-1}\)</span> es igual a 1 si no hay individuos que tengan un tiempo en común de ocurrencia del evento, por lo tanto se puede considerar este término como un factor de correción a la estructura de varianza ante la presencia de múltiples ocurrencias en un mismo tiempo (<em>ties</em>).</p>
<p>Note que <span class="math inline">\((Z_1(\tau),\ldots,Z_k(\tau))\)</span> cumple que:</p>
<p><span class="math display">\[\sum_{j=1}^k Z_j(\tau)=0\]</span></p>
<p>Seleccionamos entonces <span class="math inline">\(k-1\)</span> de las poblaciones y sea <span class="math inline">\(\Sigma\)</span> la matriz de varianza-covarianza con elementos <span class="math inline">\(\hat \sigma_{jg}\)</span>. Se define el estadístico:</p>
<p><span class="math display">\[\chi^2=(Z_1(\tau),\ldots,Z_{k-1}(\tau))\Sigma^{-1}(Z_1(\tau),\ldots,Z_{k-1}(\tau))^T\]</span></p>
<p>Bajo <span class="math inline">\(H_0\)</span> se tiene que <span class="math inline">\(\chi^2\sim \chi_{k-1}^2\)</span>. En el caso en que <span class="math inline">\(k=2\)</span>:</p>
<span class="math display">\[\begin{align*}
    Z&amp;=\frac{\sum_{i=1}^D W(t_i)\left[d_{i1}-Y_{i1}\left(\frac{d_i}{Y_i}\right)\right]}{\sqrt{\sum_{i=1}^D W(t_i)^2\frac{Y_{i1}}{Y_i}\left(1-\frac{Y_{i1}}{Y_i}\right)\left(\frac{Y_i-d_i}{Y_i-1}\right)}}\\
    &amp;\underset{H_0}{\sim} N(0,1)
\end{align*}\]</span>
<p>Por lo tanto se rechaza <span class="math inline">\(H_0: h_1(t)=h_2(t)\)</span> si <span class="math inline">\(|Z|&gt;z_{1-\alpha/2}\)</span> o se rechaza <span class="math inline">\(H_0: h_1(t)&gt;h_2(t)\)</span> si <span class="math inline">\(Z&gt;z_{1-\alpha}\)</span>.</p>
<p>Escogencias de <span class="math inline">\(W(t)\)</span>:</p>
<p>1- <span class="math inline">\(W(t)=1\)</span>: Prueba de log-rango.</p>
<p>2- <span class="math inline">\(W(t_i)=Y_i\)</span>: similar a la prueba de Wilcoxon-Mann-Whitney.</p>
<p>3- <span class="math inline">\(W(t_i)=Y_i^{1/2}\)</span> (otorga más peso donde hay más datos).</p>
<p>4- Considere</p>
<p><span class="math display">\[\tilde S(t)=\prod_{t_i\leq t}\left(1-\frac{d_i}{Y_i+1}\right)\]</span> tome <span class="math inline">\(W(t_i)=\tilde S(t_i)\)</span> (<em>Peto-Peto, (1972)</em>).</p>
<p>5- Modificación de Andersen (1982) (<em>Peto-Peto Modificada</em>)</p>
<p><span class="math display">\[W(t_i)=\frac{\tilde S(t_i)Y_i}{Y_i+1}\]</span> 6- <em>Fleming and Harrington</em></p>
<p>Sea <span class="math inline">\(\hat S(t)\)</span> el estimador de Kaplan-Meier usando la muestra combinada. Defina:</p>
<p><span class="math display">\[W_{p,q}(t_i)=\hat S(t_{i-1})^p[1-\hat S(t_{i-1})]^q, \qquad p\geq 0, q\geq 0\]</span></p>
<p>2 casos: <span class="math inline">\(p=q=0\)</span> (log-rango) y <span class="math inline">\(p=1, q=0\)</span> (Mann-Whitney-Wilcoxon)</p>
</section>
<section id="pruebas-de-tendencia" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="pruebas-de-tendencia"><span class="header-section-number">3.3</span> Pruebas de tendencia</h2>
<p>Principal objetivo: detectar alternativas ordenadas a la hipótesis nula:</p>
<ul>
<li><span class="math inline">\(H_0:h_1(t)=h_2(t)=\cdots=h_k(t)\)</span> para todo <span class="math inline">\(t\leq \tau\)</span></li>
<li><span class="math inline">\(H_1: h_1(t)\leq h_2(t)\leq \cdots\leq h_k(t)\)</span> para <span class="math inline">\(t\leq \tau\)</span> con al menos una desigualdad estricta.</li>
</ul>
<p>Note que</p>
<p><span class="math display">\[h_1(t)\leq \cdots \leq h_k(t) \Leftrightarrow S_1(t)\geq \cdots \geq S_k(t)\]</span> Usando la notación anterior, sea <span class="math inline">\(a_1&lt;a_2&lt;\cdots &lt;a_k\)</span> una secuencia de scores (usualmente <span class="math inline">\(a_j=j\)</span> o algún estadístico representativo para la población <span class="math inline">\(j\)</span>-ésima):</p>
<p><span class="math display">\[Z=\frac{\sum_{j=1}^k a_jZ_j(\tau)}{\sqrt{\sum_{j=1}^k \sum_{g=1}^k a_ja_g\hat \sigma_{jg}}}\underset{H_0}{\sim} N(0,1)\]</span></p>
<!-- ## Pruebas estratificadas -->
<!-- Suponga que se tiene un conjunto de covariables que definen $M$ estados -->
<!-- o configuraciones sobre el conjunto de $k$ poblaciones. Se quiere -->
<!-- probar: -->
<!-- $$H_0: h_{1s}(t)=h_{2s}(t)=\cdots=h_{ks}(t), \qquad s=1,\ldots,M\qquad t<\tau$$ -->
<!-- Para un estrato $s$ fijo, sea $Z_{js}(\tau)$: -->
<!-- $$Z_{js}(\tau)=\sum_{i=1}^DW(t_i)\left[\underbrace{d_{ij}-Y_{ij}\left(\frac{d_i}{Y_i}\right)}_{\text{solamente estrato s}}\right]$$ -->
<!-- y $\hat \Sigma_s$ es la matriz de varianza-covarianza de $Z_{js}$. La -->
<!-- prueba estratificada se construye definiendo: -->
<!-- $$Z_{j.}(\tau)=\sum_{s=1}^MZ_{js}(\tau)  \qquad \text{y} \qquad \hat \sigma_{jg.}=\sum_{s=1}^M \hat \sigma_{jgs}$$\ -->
<!-- y $\hat \sigma_{jgs}$ es la entrada $jg$ del $\hat \Sigma_s$. El -->
<!-- estadístico de prueba estaría dado por: -->
<!-- $$X_.=(Z_{1.}(\tau),\ldots,Z_{k-1,.}(\tau))\Sigma_.^{-1}(Z_{1.}(\tau),\ldots,Z_{k-1,.}(\tau))^T$$ -->
<!-- donde $\Sigma_.$ es la matriz con entradas $\hat \sigma_{jg.}$. Bajo -->
<!-- $H_0$: -->
<!-- $$X_.\sim \chi_{k-1}^2$$ -->
<!-- En el caso de dos muestras el estadístico se puede escribir: -->
<!-- $$\frac{\sum_{s=1}^M Z_{1s}(\tau)}{\sqrt{\sum_{s=1}^M \hat \sigma_{11s}}}\underset{H_0}{\sim}N(0,1)$$ -->
<!-- y este estadístico también permite probar hipótesis de una cola en el -->
<!-- caso de dos muestras. -->
<!-- Otro tipo de prueba basada en pruebas estratificadas es una *prueba -->
<!-- pareada*. Si $(T_{1i},T_{2i})$ son pares de eventos de interés con -->
<!-- indicadores de eventos $(\delta_{1i},\delta_{2i})$ para $i=1,\ldots,M$. -->
<!-- Queremos probar las hipótesis: -->
<!-- $$H_0: h_{1i}(t)=h_{2i}(t), \qquad i=1,\ldots,M$$ (misma interpretación -->
<!-- en términos de estratos). En este caso el estadístico $Z_{js}$ es: -->
<!-- ($j=1,2$) -->
<!-- ```{=tex} -->
<!-- \begin{align*} -->
<!-- Z_{1i}(\tau)= -->
<!--     \begin{cases} -->
<!--         W(T_{1i})\left(1-\frac 1 2\right)=\frac{W(T_{1i})}{2} & \text{bajo Escenario A}\\ -->
<!--         W(T_{2i})\left(0-\frac 1 2\right)=-\frac{W(T_{2i})}{2} & \text{bajo Escenario B}\\ -->
<!--         0 & \text{otro caso} -->
<!--     \end{cases} -->
<!-- \end{align*} -->
<!-- ``` -->
<!-- -   Escenario A: si $T_{1i}<T_{2i}$, $\delta_{1i}=1$ o $T_{1i}=T_{2i}$, -->
<!--     $\delta_{1i}=1$, $\delta_{2i}=0$. -->
<!-- -   Escenario B: $T_{2i}<T_{1i}$, $\delta_{2i}=1$ o $T_{1i}=T_{2i}$, -->
<!--     $\delta_{2i}=1$, $\delta_{1i}=0$. -->
<!-- y -->
<!-- ```{=tex} -->
<!-- \begin{align*} -->
<!-- \hat \sigma_{11i}= -->
<!--     \begin{cases} -->
<!--         W(T_{1i})^2/4 & \text{bajo Escenario A}\\ -->
<!--         W(T_{2i})^2/4 & \text{bajo Escenario B}\\ -->
<!--         0 & \text{otro caso} -->
<!--     \end{cases} -->
<!-- \end{align*} -->
<!-- ``` -->
<!-- Sumando sobre los estratos ($i=1,\ldots,M$): -->
<!-- $$Z_{1.}(\tau)=w \cdot \frac{D_1-D_2}{2}$$ y -->
<!-- $$\hat \sigma_{11.}=w^2\cdot \frac{D_1+D_2}{4}$$ donde: -->
<!-- -   $D_1$: número de parejas en donde el evento aparece en el sujeto de -->
<!--     la primera muestra. -->
<!-- -   $D_2$: número de parejas en donde el evento aparece en el sujeto de -->
<!--     la segunda muestra. -->
<!-- -   $w$: peso evaluado en el tiempo más pequeño de ocurrencia del -->
<!--     evento. -->
<!-- Entonces: -->
<!-- $$\frac{Z_{1.}(\tau)}{\sqrt{\hat \sigma_{11.}}}=\frac{D_1-D_2}{\sqrt{D_1+D_2}}\underset{H_0}{\sim}N(0,1)$$ -->
<!-- ## Pruebas de Renyi -->
<!-- *Inconveniente de las pruebas anteriores*: algunas veces las diferencias -->
<!-- en las tasas de riesgo son simétricas (un primer grupo sobrepasa al otro -->
<!-- en riesgo un número similar de veces al que el primer grupo es -->
<!-- sobrepasado por el otro grupo). Esto provoca problemas de potencia en la -->
<!-- prueba. *Solución*: utilizar otras medidas de comparación. -->
<!-- Suponga que se tiene dos muestras independientes de tamaño $n_1$ y $n_2$ -->
<!-- respectivamente. -->
<!-- Sea $n=n_1+n_2$ y $t_1<t_2<\cdots<t_D$ los distintos tiempo de -->
<!-- ocurrencia en la muestra combinada y $Y_{ij}$: número de individuos en -->
<!-- riesgo en tiempo $t_i$ ($j=1,2$). Al igual que antes -->
<!-- $Y_i=Y_{i1}+Y_{i2}$, $d_i=d_{i1}+d_{i2}$ (eventos ocurridos). Sea $W(t)$ -->
<!-- la función de pesos (como las consideradas anteriormente). En este caso -->
<!-- se calcula: -->
<!-- $$Z(t_i)=\sum_{t_k\leq t_i}W(t_k)\left[d_{k1}-Y_{k1}\left(\frac{d_k}{Y_k}\right)\right]\qquad i=1,\ldots,D$$ -->
<!-- y  -->
<!-- $$\sigma(\tau)=\sum_{t_k\leq \tau}W(t_k)^2\left(\frac{Y_{k1}}{Y_k}\right)\left(\frac{Y_{k2}}{Y_k}\right)\left(\frac{Y_{k}-d_k}{Y_k-1}\right)d_k$$ -->
<!-- donde $\tau$ es el $t_k$ máximo tal que $Y_{k1}, Y_{k2}>0$.  -->
<!-- Bajo la hipótesis:  -->
<!-- - $H_0: h_1(t)=h_2(t),\qquad t<\tau$ -->
<!-- - $H_1: h_1(t)\neq h_2(t)$ -->
<!-- el estadístico de prueba es: -->
<!-- $$Q=\sup_{t\leq \tau}\frac{|Z(t)|}{\sigma(\tau)}$$ -->
<!-- cuya distribución bajo $H_0$ se aproxima con la distribución de $\sup_{0\leq x\leq 1}|B(x)|$ donde $B$ es un proceso Browniano estándar. -->
<!-- ## Pruebas en un punto fijo en el tiempo -->
<!-- *Objetivo*: hacer comparaciones de funciones de sobrevivencia o curvas de incidencia de $k$ poblaciones en un punto fijo en el tiempo $t_0$. -->
<!-- Sea $\Theta^T=(\theta_1,\ldots,\theta_p)$ un vector de parámetros de dimensión $p$. Definimos un contraste como con conjunto de coeficientes $c=(c_1,\ldots,c_p)$ que definen una combinación lineal de parámetros $\theta^c=c\Theta=c_1\theta_1+\cdots+c_p\theta_p$.  -->
<!-- **Ejemplo**: si $p=3$ y $c=(1,-1,0)$, entonces $\theta^c=\theta_1-\theta_2$. Decir que $H_0: \theta^c=0$ es equivalente a decir que $H_0:\theta_1=\theta_2$. -->
<!-- Suponga que se tiene $q$ contrastes $c_k=(c_{k1},\ldots,c_{kp})$ para $k=1,\ldots,q$ y se tiene que probar las hipótesis: -->
<!-- $$H_0: c_k\Theta=0\qquad \forall k$$ -->
<!-- Defina la matriz de contrastes:  -->
<!-- \begin{align*} -->
<!-- C= -->
<!--    \begin{pmatrix} -->
<!--    c_1\\ -->
<!--    \vdots \\ -->
<!--    c_q -->
<!--    \end{pmatrix} -->
<!-- \end{align*} -->
<!-- Si $\hat \theta_j$ es el estimador de $\theta_j$ con matriz de varianza $V$ (con entradas $\hat V(\hat \theta_j,\hat \theta_k)$) ($V$: varianza). Entonces si se quiere probar: -->
<!-- $$H_0: C\Theta^T=0$$ -->
<!-- El estadístico de prueba es: -->
<!-- $$X^2=[C\Theta]^T[CVC^T]^{-1}[C\Theta]\underset{H_0}{\sim}\chi_q^2$$ -->
<!-- Caso particular: -->
<!-- - $H_0: S_1(t_0)=S_2(t_0)=\cdots S_k(t_0)$ vs $H_1$: al menos uno de los $S_j(t_0)$ es distinto. -->
<!-- - $H_0: CI_1(t_0)=CI_2(t_0)=\cdots =CI_k(t_0)$ vs $H_1$: al menos uno de los $CI_j(t_0)$ es distinto. -->
<!-- Sea $\hat \theta_j$ el estimador de Kaplan-Meier de $S_j(t_0)$ o la curva de incidencia estimada en $t_0$. Sea  -->
<!-- \begin{align*} -->
<!-- C= -->
<!--    \begin{pmatrix} -->
<!--      1 & 0 & 0 & \cdots & 0 & -1 \\ -->
<!--      0 & 1 & 0 & \cdots & 0 & -1 \\ -->
<!--      \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ -->
<!--      0 & 0 & 0 & \cdots & 1 & -1 -->
<!--    \end{pmatrix} -->
<!-- \end{align*} -->
<!-- y $V=\text{diag}(\hat V(\hat \theta_k(t_0)))$. Entonces: -->
<!-- \begin{align*} -->
<!-- X^2&= -->
<!--    \begin{pmatrix} -->
<!--        \hat \theta_1-\hat \theta_p\\ -->
<!--        \vdots\\ -->
<!--        \hat \theta_{p-1}-\hat \theta_p -->
<!--    \end{pmatrix}^T -->
<!--    \begin{pmatrix} -->
<!--        V_1+V_p & V_p & \cdots & V_p \\ -->
<!--        V_p & V_2+V_p & \cdots & V_p \\ -->
<!--        \vdots & \vdots & \vdots & \vdots \\ -->
<!--        V_p & V_p & \cdots & V_{p-1}+V_p -->
<!--    \end{pmatrix}^{-1} -->
<!--    \begin{pmatrix} -->
<!--        \hat \theta_1-\hat \theta_p\\ -->
<!--        \vdots\\ -->
<!--        \hat \theta_{p-1}-\hat \theta_p -->
<!--    \end{pmatrix}\\ -->
<!--    & \underset{H_0}{\sim} \chi_{p-1}^2 -->
<!-- \end{align*} -->
<!-- Caso particular (p=2): -->
<!-- Con la hipótesis nula $H_0: S_1(t_0)=S_2(t_0)$: -->
<!-- $$Z=\frac{\hat S_1(t_0)-\hat S_2(t_0)}{\sqrt{\hat V(\hat S_1(t_0))+\hat V(\hat S_2(t_0))}}\underset{H_0}{\sim}N(0,1)$$ -->
<!-- **Nota**: Si se quiere hacer comparaciones simultáneas ($k$ en total, 2 a 2) se puede usar un factor de corrección de *Bonferroni* (Ejercicio). -->
<!-- ## Laboratorio -->
<!-- ### Prueba de una muestra -->
<!-- Carga de paquetes básicos: -->
<!-- ```{r message=FALSE, warning=FALSE} -->
<!-- library(survival) -->
<!-- library(KMsurv) -->
<!-- library(survMisc) -->
<!-- library(tidyverse) -->
<!-- ``` -->
<!-- Este cálculo busca replicar el ejemplo 7.1 en donde se compara la -->
<!-- mortalidad en una muestra de 26 pacientes psiquiátricos en Iowa con -->
<!-- respecto a la mortalidad general de la población del mismo estado en el -->
<!-- año 1960. Primero cargamos los datos: -->
<!-- ```{r} -->
<!-- data("psych") -->
<!-- head(psych) -->
<!-- ``` -->
<!-- y cargamos la información de la mortalidad de todo Iowa (1:Hombres, -->
<!-- 2:Mujeres): -->
<!-- ```{r} -->
<!-- Iowa_mort <- read_csv('./data/Iowa_1960.csv')     -->
<!-- colnames(Iowa_mort) <- c('age','1','2') -->
<!-- head(Iowa_mort) -->
<!-- ``` -->
<!-- Después de algunos cambios, unimos las dos fuentes de información: -->
<!-- ```{r} -->
<!-- Iowa_mort <- Iowa_mort %>%  -->
<!--   pivot_longer(-age,names_to = 'sex',values_to = 'Survival') %>% -->
<!--   mutate(sex=as.numeric(sex)) -->
<!-- psych <- psych %>% left_join(Iowa_mort) %>% mutate(age2=age+time) -->
<!-- head(psych) -->
<!-- ``` -->
<!-- Se maneja dos distintas situaciones bajo estos datos censurados por la -->
<!-- derecha: (1) truncamiento por la izquierda o (2) ningún truncamiento: -->
<!-- ```{r} -->
<!-- attach(psych) -->
<!-- surv_7_1 <- Surv(time = age,time2 = age2,event = death,type = 'counting') -->
<!-- surv_7_1_b <- Surv(time = age2,event = death) -->
<!-- ``` -->
<!-- Si queremos comparar las dos distribuciones sin asumir truncamiento por -->
<!-- la izquierda se puede ejecutar: -->
<!-- ```{r} -->
<!-- S_7_1_b <- survdiff(surv_7_1_b~offset(Survival)) -->
<!-- S_7_1_b -->
<!-- ``` -->
<!-- En donde concluimos que la mortalidad de los pacientes es distinta a la -->
<!-- resto del estado bajo los niveles de significancia usuales. En el caso -->
<!-- de truncamiento por la izquierda, hacemos el cálculo de manera directa: -->
<!-- ```{r} -->
<!-- psych <- psych %>% mutate(H=-log(Survival)) -->
<!-- Iowa_mort <- Iowa_mort %>% select(age2=age,sex,Survival2=Survival) -->
<!-- psych <- psych %>% left_join(Iowa_mort) %>%  -->
<!--   mutate(H2=-log(Survival2)) %>% -->
<!--   mutate(dif=H2-H) -->
<!-- Otau <- sum(psych$death) -->
<!-- Etau <- sum(psych$dif) -->
<!-- X2 <- (Otau-Etau)^2/Etau -->
<!-- valor_p <- pchisq(q = X2,df = 1,lower.tail = F) -->
<!-- show(valor_p) -->
<!-- detach(psych) -->
<!-- ``` -->
<!-- Por lo que llegamos a la misma conclusión. -->
<!-- ### Prueba de dos muestras -->
<!-- El primer conjunto de datos mide la efectividad de dos técnicas -->
<!-- distintas de colocación de catéteres en procedimientos de diálisis en -->
<!-- riñones. -->
<!-- ```{r} -->
<!-- data("kidney")   -->
<!-- head(kidney) -->
<!-- ``` -->
<!-- Primero estimamos las funciones de sobrevivencia según Kaplan-Meier: -->
<!-- ```{r} -->
<!-- attach(kidney) -->
<!-- library(survminer) -->
<!-- surv_7_2 <- Surv(time,event = delta) -->
<!-- S_7_2 <- survfit(surv_7_2~type,data = kidney) -->
<!-- ggsurvplot(S_7_2) -->
<!-- ``` -->
<!-- Y comparamos las tasas de riesgo bajo los dos procedimientos bajo -->
<!-- distintas escogencias de funciones de pesos $W(t)$ (log-rank, Peto-Peto -->
<!-- y tres posibilidades de escogencia de Fleming-Harrington): -->
<!-- ```{r} -->
<!-- X_7_2_logrank <- survdiff(surv_7_2~type,data = kidney,rho = 0) -->
<!-- X_7_2_logrank -->
<!-- X_7_2_PetoPeto <- survdiff(surv_7_2~type,data = kidney,rho = 1) -->
<!-- X_7_2_PetoPeto -->
<!-- library(FHtest) # http://www.bioconductor.org/packages/release/bioc/html/Icens.html -->
<!-- X_7_2_FH1 <- FHtestrcc(surv_7_2~type,data = kidney,rho = 0,lambda=1) -->
<!-- X_7_2_FH1 -->
<!-- X_7_2_FH2 <- FHtestrcc(surv_7_2~type,data = kidney,rho = 1,lambda=0) -->
<!-- X_7_2_FH2 -->
<!-- X_7_2_FH3 <- FHtestrcc(surv_7_2~type,data = kidney,rho = 1,lambda=1) -->
<!-- X_7_2_FH3 -->
<!-- detach(kidney) -->
<!-- ``` -->
<!-- Noten que bajo algunas escogencias de pesos no hay evidencia suficiente -->
<!-- para rechazar la igualdad entre tasas de riesgos. -->
<!-- El ejemplo 7.3 del Klein busca comparar dos tasas de riesgo bajo un -->
<!-- esquema de truncamiento por la izquierda. En este caso se usa los datos -->
<!-- de la casa de retiro Channing, que anteriormente habíamos usado para -->
<!-- comparar entre hombres y mujeres la sobrevivencia de adultos mayores. -->
<!-- Ahora se busca probar $H_0:h_F(t)=h_M(t)$ contra la alternativa de una -->
<!-- cola $H_A:h_F(t)\leq h_M(t)$. -->
<!-- ```{r} -->
<!-- data("channing")   -->
<!-- head(channing) -->
<!-- attach(channing) -->
<!-- surv_7_3 <- Surv(time = ageentry,time2 = age,event = death,type = 'counting') -->
<!-- S_7_3 <- coxph(surv_7_3~gender) -->
<!-- summary(S_7_3) -->
<!-- ``` -->
<!-- En este caso el estadístico de prueba corresponde al de la prueba Score -->
<!-- (3.36). Como la prueba es de una cola, el valor p se puede calcular -->
<!-- directamente: -->
<!-- ```{r} -->
<!-- pnorm(sqrt(3.36),lower.tail = F) -->
<!-- detach(channing) -->
<!-- ``` -->
<!-- Lo que da evidencia de que bajo un nivel de confianza en la muestra del -->
<!-- 95%, podríamos rechazar la hipótesis de que las dos tasas de riesgo son -->
<!-- idénticas a favor de que de las mujeres es mayor a la de los hombres. -->
<!-- El ejemplo 7.4 usa los datos de 137 pacientes que iban a someterse a un -->
<!-- transplante de médula ósea bajo tres distintas condiciones de leucemia -->
<!-- (ALL, AML-low, AML-high). Vamos a comparar la sobrevivencia de los -->
<!-- pacientes bajo estos tres grupos de riesgo. -->
<!-- ```{r} -->
<!-- data("bmt") -->
<!-- head(bmt) -->
<!-- ``` -->
<!-- Las funciones de sobrevivencia estimadas se grafican: -->
<!-- ```{r} -->
<!-- S_7_4 <- survfit(Surv(time=t2, event=d3) ~ group, data=bmt) -->
<!-- ggsurvplot(S_7_4) -->
<!-- ``` -->
<!-- y probamos la hipótesis de la igualdad de tasas de riesgo entre los tres -->
<!-- grupos, usando tres posibilidades de escogencia de parámetros de -->
<!-- Fleming-Harrington, y bajo las opciones de log-rank y Gehan: -->
<!-- ```{r} -->
<!-- b1 <- ten(Surv(time=t2, event=d3) ~ group, data=bmt) -->
<!-- pruebas_7_4 <- comp(b1, p=c(1, 0, 1), q=c(0, 1, 1)) -->
<!-- ``` -->
<!-- Note que en esta versión del paquete *survMisc* los valores p no son -->
<!-- calculados correctamente. Por ejemplo, para el caso de la prueba con -->
<!-- pesos de Gehan este se podría calcular como: -->
<!-- ```{r} -->
<!-- pchisq(16.2407,df = 2,lower.tail = F) -->
<!-- ``` -->
<!-- Por lo tanto bajo los niveles de confianza usuales se rechaza la -->
<!-- hipótesis de que las tres tasas de riesgo son iguales para cualquier -->
<!-- $t$. -->
<!-- ### Pruebas de tendencia -->
<!-- Como ejemplo de la prueba de tendencia se utiliza una base de 40 -->
<!-- pacientes con cáncer de laringe clasificados según la etapa de la -->
<!-- enfermedad. Se probará la hipótesis de que no hay una diferencia entre -->
<!-- las tasas de riesgo entre las 4 etapas vs la hipótesis de que entre más -->
<!-- alta la etapa, más alta la tasa de riesgo. Graficamos las 4 funciones de -->
<!-- sobrevivencia estimadas: -->
<!-- ```{r} -->
<!-- data("larynx") -->
<!-- S_7_6 <- survfit(Surv(time, delta) ~ stage,data=larynx) -->
<!-- ggsurvplot(S_7_6) -->
<!-- ``` -->
<!-- y el estadístico de prueba lo calculamos con la función *comp*, usando -->
<!-- como scores $a_j=j, \; 1,\ldots,4$ y bajo distintas escogencias de -->
<!-- funciones de pesos: -->
<!-- ```{r} -->
<!-- l1 <- ten(Surv(time, delta) ~ stage, data=larynx) -->
<!-- comp(l1) -->
<!-- p <- attr(l1, "tft") -->
<!-- p$tft$pChisq -->
<!-- ``` -->
<!-- Por ejemplo para el caso de la prueba con pesos de Tarone, el valor p -->
<!-- es: -->
<!-- ```{r} -->
<!-- 2*pnorm(4.0580,lower.tail = F) -->
<!-- ``` -->
<!-- por lo que se rechaza la hipótesis nula inmediatamente, a favor de una -->
<!-- en donde las tasas son crecientes. -->
<!-- ### Pruebas estratificadas -->
<!-- Como complemento al ejemplo de la sobrevivencia en pacientes con -->
<!-- leucemia, se incluye la covariable de uso del químico MTX como -->
<!-- profiláctico en el tratamiento, el cual puede ser una variable confusora -->
<!-- en la prueba del ejemplo 7.4. -->
<!-- ```{r} -->
<!-- S_7_4_est <- survfit(Surv(time=t2, event=d3) ~ group+strata(z10), data=bmt) -->
<!-- ggsurvplot(S_7_4_est) -->
<!-- ``` -->
<!-- y hacemos una prueba de log-rango con el paquete *survival*: -->
<!-- ```{r} -->
<!-- Prueba_7_4_est <- survdiff(Surv(time=t2, event=d3) ~ group+strata(z10), data=bmt) -->
<!-- print(Prueba_7_4_est) -->
<!-- ``` -->
<!-- por lo tanto se rechaza la hipótesis nula de igualdad de tasas de -->
<!-- riesgo, independientemente del efecto del uso del químico MTX en la -->
<!-- población de estudio. -->
<!-- ### Prueba de Renyi -->
<!-- Para ilustrar el uso de la prueba de Renyi usamos los datos de -->
<!-- sobrevivencia de 45 pacientes con cáncer gástrico a los cuales se les -->
<!-- aplicó quimioterapia o la combinación de quimioterapia y radiación. Las -->
<!-- funciones de sobrevivencia estimadas son: -->
<!-- ```{r} -->
<!-- data("gastric") -->
<!-- S_7_9_est <- survfit(Surv(time, event) ~ group, data=gastric) -->
<!-- ggsurvplot(S_7_9_est) -->
<!-- ``` -->
<!-- donde es muy evidente que las dos funciones de sobrevivencia se cruzan -->
<!-- en una edad intermedia, por lo que es mejor usar la prueba de Renyi: -->
<!-- ```{r} -->
<!-- g1 <- ten(Surv(time, event) ~ group, data=gastric) -->
<!-- pba <- comp(g1) -->
<!-- attr(g1, "sup") -->
<!-- p <- attr(g1, "sup") -->
<!-- ``` -->
<!-- y los valores p correspondientes para cada una de las escogencias de pesos son: -->
<!-- ```{r message=FALSE, warning=FALSE} -->
<!-- p$pSupBr -->
<!-- ``` -->
<!-- Por lo que rechazaríamos la hipótesis de igualdad de tasas de riesgo -->
<!-- para niveles de significacia superiores al 5% aproximadamente para todos los casos excepto la primera y la última ponderación. -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./estNP.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimación No-Paramétrica</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Referencias</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>